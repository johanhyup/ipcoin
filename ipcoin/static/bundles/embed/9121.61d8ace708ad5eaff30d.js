"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[9121],{759214:(e,t,i)=>{i.d(t,{containsBackgroundTimePointIndexes:()=>r,dematerializeBackground:()=>a,isBackgroundInBarsRange:()=>d,materializeBackground:()=>l});var n=i(650151),o=i(501571),s=i(585240);const r=!0;function l(e,t){if(e.start>=t.length||e.stop>=t.length)return null;const i=t[e.start],s=t[e.stop];return s===o.INVALID_TIME_POINT_INDEX?null:((0,n.assert)(i===o.INVALID_TIME_POINT_INDEX||i<=s,"start should not exceed stop"),{start:i===o.INVALID_TIME_POINT_INDEX?null:i,stop:s})}function a(e,t,i){return{id:t,start:(0,s.ensureTimePointIndexIndex)(i.indexOf(null!==e.start?e.start:o.INVALID_TIME_POINT_INDEX)),stop:(0,s.ensureTimePointIndexIndex)(i.indexOf(e.stop))}}function d(e,t){if(null===e.start)return t.firstBar()<=e.stop;const i=Math.min(e.start,e.stop),n=Math.max(e.start,e.stop);return t.contains(i)||t.contains(n)||i<t.firstBar()&&n>t.lastBar()}},18613:(e,t,i)=>{i.d(t,{DwgBoxStyle:()=>n,containsDwgBoxTimePointIndexes:()=>d,dematerializeDwgBox:()=>h,isDwgBoxInBarsRange:()=>p,materializeDwgBox:()=>c});var n,o,s,r=i(501571),l=i(585240),a=i(597461);!function(e){e.Solid="sol",e.Dotted="dot",e.Dashed="dsh",e.LeftArrow="al",e.RightArrow="ar",e.BothArrow="ab"}(n||(n={})),function(e){e.Top="top",e.Center="center",e.Bottom="bottom"}(o||(o={})),function(e){e.Monospace="monospace"}(s||(s={}));const d=!0;function c(e,t){if(e.x1>=t.length||e.x2>=t.length||null===e.y1||null===e.y2)return null;let i=t[e.x1],n=t[e.x2];return i===r.INVALID_TIME_POINT_INDEX&&(i=null),n===r.INVALID_TIME_POINT_INDEX&&(n=null),{left:i,right:n,top:e.y1,bottom:e.y2,borderColorIndex:e.c,backgroundColorIndex:e.bc,extend:e.ex,borderStyle:e.st,borderWidth:e.w,text:e.t,textFormatting:e.tfrm??0,wordWrap:e.tw,horizontalTextAlignment:e.tha,verticalTextAlignment:e.tva,fontSize:e.ts,textColorIndex:e.tc??null,fontType:e.tf??null,forceOverlay:e.fo}}function h(e,t,i){return{id:t,x1:(0,l.ensureTimePointIndexIndex)(i.indexOf(e.left??r.INVALID_TIME_POINT_INDEX)),x2:(0,l.ensureTimePointIndexIndex)(i.indexOf(e.right??r.INVALID_TIME_POINT_INDEX)),y1:e.top,y2:e.bottom,c:e.borderColorIndex,bc:e.backgroundColorIndex,ex:e.extend,st:e.borderStyle,w:e.borderWidth,t:e.text,tw:e.wordWrap,tha:e.horizontalTextAlignment,tva:e.verticalTextAlignment,tfrm:e.textFormatting,ts:e.fontSize,tf:e.fontType??void 0,tc:e.textColorIndex,fo:e.forceOverlay}}function p(e,t){const i=e.extend;if(i===a.DwgExtend.Both)return null===e.left||null===e.right;if(null===e.left||null===e.right)return null!==e.right?e.right<=t.lastBar()&&i===a.DwgExtend.Right:null!==e.left&&(e.left>=t.firstBar()&&i===a.DwgExtend.Left);const n=Math.min(e.left,e.right),o=Math.max(e.left,e.right);if(t.contains(n)||t.contains(o)||n<t.firstBar()&&o>t.lastBar())return!0;const s=e.left<e.right?e.extend===a.DwgExtend.Left:e.extend===a.DwgExtend.Right,r=e.left<e.right?e.extend===a.DwgExtend.Right:e.extend===a.DwgExtend.Left;return o<t.firstBar()&&r||n>t.lastBar()&&s}},15141:(e,t,i)=>{i.d(t,{DwgLabelStyle:()=>s,DwgLabelTextAlign:()=>n,
DwgLabelYloc:()=>o,containsDwgLabelTimePointIndexes:()=>d,dematerializeDwgLabel:()=>h,isDwgLabelInBarsRange:()=>p,materializeDwgLabel:()=>c});var n,o,s,r,l=i(501571),a=i(585240);!function(e){e.Left="left",e.Center="center",e.Right="right"}(n||(n={})),function(e){e.AboveBar="ab",e.BelowBar="bl",e.Price="pr",e.Auto="auto"}(o||(o={})),function(e){e.Xcross="xcr",e.Cross="cr",e.Triangleup="tup",e.Triangledown="tdn",e.Flag="flg",e.Circle="cir",e.Arrowup="aup",e.Arrowdown="adn",e.LabelUp="lup",e.LabelDown="ldn",e.LabelLeft="llf",e.LabelRight="lrg",e.LabelCenter="lcn",e.LabelLeftUp="luplf",e.LabelLeftDown="llwlf",e.LabelRightUp="luprg",e.LabelRightDown="llwrg",e.Square="sq",e.Diamond="dia",e.TextOutline="to",e.None="n"}(s||(s={})),function(e){e.Monospace="monospace"}(r||(r={}));const d=!0;function c(e,t){if(e.x>=t.length)return null;const i=t[e.x];return i===l.INVALID_TIME_POINT_INDEX?null:{x:i,y:e.y,yloc:e.yl,text:e.t,style:e.st,size:e.sz,colorIndex:e.ci,textColorIndex:e.tci,textAlign:e.ta||n.Center,tooltip:e.tt||"",fontType:e.tf??null,forceOverlay:e.fo,textFormatting:e.tfrm??0}}function h(e,t,i){return{id:t,x:(0,a.ensureTimePointIndexIndex)(i.indexOf(e.x)),y:e.y,yl:e.yloc,t:e.text,st:e.style,sz:e.size,ci:e.colorIndex,tci:e.textColorIndex,ta:e.textAlign,tt:e.tooltip,tf:e.fontType??void 0,fo:e.forceOverlay,tfrm:e.textFormatting}}function p(e,t){return t.contains(e.x)}},276507:(e,t,i)=>{i.d(t,{containsDwgLineFillTimePointIndexes:()=>n,dematerializeDwgLineFill:()=>s,materializeDwgLineFill:()=>o});const n=!1;function o(e){return{id:e.id,line1:e.line1,line2:e.line2,colorIndex:e.ci}}function s(e,t){return{id:t,line1:e.line1,line2:e.line2,ci:e.colorIndex}}},164937:(e,t,i)=>{i.d(t,{DwgLineStyle:()=>n,containsDwgLineTimePointIndexes:()=>l,dematerializeDwgLine:()=>d,isDwgLineInBarsRange:()=>c,materializeDwgLine:()=>a});var n,o=i(501571),s=i(585240),r=i(597461);!function(e){e.Solid="sol",e.Dotted="dot",e.Dashed="dsh",e.LeftArrow="al",e.RightArrow="ar",e.BothArrow="ab"}(n||(n={}));const l=!0;function a(e,t){if(e.x1>=t.length||e.x2>=t.length||null===e.y1||null===e.y2)return null;let i=t[e.x1],n=t[e.x2];return i===o.INVALID_TIME_POINT_INDEX&&(i=null),n===o.INVALID_TIME_POINT_INDEX&&(n=null),null!==i&&null!==n||e.y1===e.y2?{id:e.id,x1:i,y1:e.y1,x2:n,y2:e.y2,style:e.st,extend:e.ex,width:e.w,colorIndex:e.ci,forceOverlay:e.fo}:null}function d(e,t,i){const n=(0,s.ensureTimePointIndexIndex)(i.indexOf(e.x1??o.INVALID_TIME_POINT_INDEX)),r=(0,s.ensureTimePointIndexIndex)(i.indexOf(e.x2??o.INVALID_TIME_POINT_INDEX));return{id:t,x1:n,y1:e.y1,x2:r,y2:e.y2,st:e.style,ex:e.extend,w:e.width,ci:e.colorIndex,fo:e.forceOverlay}}function c(e,t){const i=e.extend;if(i===r.DwgExtend.Both)return!0;if(null===e.x1||null===e.x2)return null!==e.x2?e.x2<=t.lastBar()&&i===r.DwgExtend.Right:null!==e.x1&&(e.x1>=t.firstBar()&&i===r.DwgExtend.Left);const n=Math.min(e.x1,e.x2),o=Math.max(e.x1,e.x2);if(t.contains(n)||t.contains(o)||n<t.firstBar()&&o>t.lastBar())return!0
;const s=e.x1<e.x2?e.extend===r.DwgExtend.Left:e.extend===r.DwgExtend.Right,l=e.x1<e.x2?e.extend===r.DwgExtend.Right:e.extend===r.DwgExtend.Left;return o<t.firstBar()&&l||n>t.lastBar()&&s}},551789:(e,t,i)=>{i.d(t,{DwgPolylineStyle:()=>r,containsDwgPolylineTimePointIndexes:()=>s,dematerializeDwgPolyline:()=>a,isDwgPolylineInBarsRange:()=>d,materializeDwgPolyline:()=>l});var n=i(585240),o=i(501571);const s=!0;var r;function l(e,t){const i=[];for(const n of e.points){if(n.x>=t.length)continue;const e=t[n.x];e!==o.INVALID_TIME_POINT_INDEX&&i.push({x:e,y:n.y})}return 0===i.length?null:{id:e.id,points:i,width:e.w,curved:e.crv,closed:e.cls,color:e.c,fillColor:e.fc,style:e.st,forceOverlay:e.fo}}function a(e,t,i){return{id:t,points:e.points.map((e=>({x:(0,n.ensureTimePointIndexIndex)(i.indexOf(e.x??o.INVALID_TIME_POINT_INDEX)),y:e.y}))),w:e.width,crv:e.curved,cls:e.closed,c:e.color,fc:e.fillColor,st:e.style,fo:e.forceOverlay}}function d(e,t){if(0===e.points.length)return!1;const i=t.firstBar(),n=t.lastBar();let o=!1,s=!1;for(const r of e.points){if(t.contains(r.x))return!0;if(r.x<i?o=!0:r.x>n&&(s=!0),o&&s)return!0}return!1}!function(e){e.Solid="sol",e.Dotted="dot",e.Dashed="dsh",e.ArrowLeft="al",e.ArrowRight="ar",e.ArrowBoth="ab"}(r||(r={}))},817959:(e,t,i)=>{var n,o;i.d(t,{DwgTableCellFontType:()=>o,containsDwgTableCellTimePointIndexes:()=>a,containsDwgTableTimePointIndexes:()=>s,dematerializeDwgTable:()=>l,dematerializeDwgTableCell:()=>c,materializeDwgTable:()=>r,materializeDwgTableCell:()=>d}),function(e){e.Top="top",e.Center="center",e.Bottom="bottom"}(n||(n={})),function(e){e.Monospace="monospace"}(o||(o={}));const s=!1;function r(e,t){return{id:e.id,position:e.pos,rows:e.rows,columns:e.cols,backgroundColorIndex:e.bgc,frameColorIndex:e.frmc,frameWidth:e.frmw,borderColorIndex:e.brdc,borderWidth:e.brdw,forceOverlay:e.fo}}function l(e,t,i){return{id:t,pos:e.position,rows:e.rows,cols:e.columns,bgc:e.backgroundColorIndex,frmc:e.frameColorIndex,frmw:e.frameWidth,brdc:e.borderColorIndex,brdw:e.borderWidth,fo:e.forceOverlay}}const a=!1;function d(e,t){return{tableId:e.tid,row:e.row,column:e.col,widthInPercentsOfPaneWidth:e.w,heightInPercentOfPaneHeight:e.h,text:e.t,textColorIndex:e.tc,horizontalTextAlignment:e.tha,verticalTextAlignment:e.tva,fontSize:e.ts,backgroundColorIndex:e.bgc,colSpan:e.colspan??1,rowSpan:e.rowspan??1,tooltip:e.tt,fontType:e.tf??null,textFormatting:e.tfrm??0}}function c(e,t,i){return{id:t,tid:e.tableId,row:e.row,col:e.column,w:e.widthInPercentsOfPaneWidth,h:e.heightInPercentOfPaneHeight,t:e.text,tc:e.textColorIndex,tha:e.horizontalTextAlignment,tva:e.verticalTextAlignment,ts:e.fontSize,bgc:e.backgroundColorIndex,colspan:e.colSpan,rowspan:e.rowSpan,tt:e.tooltip,tf:e.fontType??void 0,tfrm:e.textFormatting}}},307801:(e,t,i)=>{i.d(t,{HHistDirection:()=>r.HHistDirection,HHistLocation:()=>r.HHistLocation,HHistVolumeMode:()=>r.HHistVolumeMode,containsHHistTimePointIndexes:()=>l,dematerializeHHist:()=>d,isHHistInBarsRange:()=>c,materializeHHist:()=>a});var n=i(650151),o=i(501571),s=i(585240),r=i(577916);const l=!0
;function a(e,t){if(e.lastBarTime>=t.length)return null;const i=t[e.firstBarTime],s=t[e.lastBarTime];return s===o.INVALID_TIME_POINT_INDEX?null:((0,n.assert)(i<=s,"firstBarTime should not exceed lastBarTime"),(0,n.assert)(e.priceLow<=e.priceHigh,"priceLow should not exceed priceHigh"),{firstBarTime:i===o.INVALID_TIME_POINT_INDEX?null:i,lastBarTime:s,rate:e.rate,priceHigh:e.priceHigh,priceLow:e.priceLow})}function d(e,t,i){const n=(0,s.ensureTimePointIndexIndex)(i.indexOf(e.firstBarTime??o.INVALID_TIME_POINT_INDEX)),r=(0,s.ensureTimePointIndexIndex)(i.indexOf(e.lastBarTime));return{id:t,...e,firstBarTime:n,lastBarTime:r}}function c(e,t){const i=Math.min(e.firstBarTime??o.INVALID_TIME_POINT_INDEX,e.lastBarTime),n=Math.max(e.firstBarTime??o.INVALID_TIME_POINT_INDEX,e.lastBarTime);return t.contains(i)||t.contains(n)||i<t.firstBar()&&n>t.lastBar()}},224621:(e,t,i)=>{i.d(t,{containsHorizLineTimePointIndexes:()=>r,dematerializeHorizLine:()=>a,isHorizLineInBarsRange:()=>d,materializeHorizLine:()=>l});var n=i(650151),o=i(501571),s=i(585240);const r=!0;function l(e,t){if(e.startIndex>=t.length||e.endIndex>=t.length)return null;const i=t[e.startIndex],s=t[e.endIndex];return s===o.INVALID_TIME_POINT_INDEX?null:((0,n.assert)(i<=s,"startIndex should not exceed endIndex"),{startIndex:i===o.INVALID_TIME_POINT_INDEX?null:i,endIndex:s,level:e.level,extendLeft:e.extendLeft,extendRight:e.extendRight})}function a(e,t,i){const n=(0,s.ensureTimePointIndexIndex)(i.indexOf(e.startIndex??o.INVALID_TIME_POINT_INDEX)),r=(0,s.ensureTimePointIndexIndex)(i.indexOf(e.endIndex));return{id:t,...e,startIndex:n,endIndex:r}}function d(e,t){if(null===e.startIndex)return t.firstBar()<=e.endIndex;const i=Math.min(e.startIndex,e.endIndex),n=Math.max(e.startIndex,e.endIndex);if(t.contains(i)||t.contains(n)||i<t.firstBar()&&n>t.lastBar())return!0;const o=e.startIndex<e.endIndex?e.extendLeft:e.extendRight,s=e.startIndex<e.endIndex?e.extendRight:e.extendLeft;return n<t.firstBar()&&s||i>t.lastBar()&&o}},951586:(e,t,i)=>{var n;i.d(t,{TextPos:()=>n,containsLevelTimePointIndexes:()=>o,dematerializeLevel:()=>r,materializeLevel:()=>s}),function(e){e[e.TopLeft=0]="TopLeft",e[e.TopCenter=1]="TopCenter",e[e.TopRight=2]="TopRight",e[e.MiddleLeft=3]="MiddleLeft",e[e.MiddleCenter=4]="MiddleCenter",e[e.MiddleRight=5]="MiddleRight",e[e.BottomLeft=6]="BottomLeft",e[e.BottomCenter=7]="BottomCenter",e[e.BottomRight=8]="BottomRight"}(n||(n={}));const o=!1;function s(e){return{level:e.level,text:e.text}}function r(e,t,i){return{id:t,...e}}},649420:(e,t,i)=>{i.d(t,{containsLineTimePointIndexes:()=>r,dematerializeLine:()=>a,isLineInBarsRange:()=>d,materializeLine:()=>l});var n=i(650151),o=i(501571),s=i(585240);const r=!0;function l(e,t){if(e.startIndex>=t.length||e.endIndex>=t.length)return null;const i=t[e.startIndex],s=t[e.endIndex];return i===o.INVALID_TIME_POINT_INDEX||s===o.INVALID_TIME_POINT_INDEX?null:((0,n.assert)(i<=s,"startIndex should not exceed endIndex"),{startIndex:i,endIndex:s,startOffset:e.startOffset,endOffset:e.endOffset,startPrice:e.startPrice,endPrice:e.endPrice
})}function a(e,t,i){const n=(0,s.ensureTimePointIndexIndex)(i.indexOf(e.startIndex)),o=(0,s.ensureTimePointIndexIndex)(i.indexOf(e.endIndex));return{id:t,...e,startIndex:n,endIndex:o}}function d(e,t){const i=e.startIndex+(e.startOffset??0),n=e.endIndex+(e.endOffset??0),o=Math.min(i,n),s=Math.max(i,n);return t.contains(i)||t.contains(n)||o<t.firstBar()&&s>t.lastBar()}},377352:(e,t,i)=>{i.d(t,{LiveStudyGraphics:()=>R});var n=i(650151),o=i(828473),s=i(942634),r=i(307801),l=i(224621),a=i(267439),d=i(239041),c=i(759214),h=i(15141),p=i(164937),m=i(551789),x=i(18613),u=i(951586),I=i(649420),f=i(521854),g=i(968632),w=i(323070),_=i(817959),T=i(276507),v=i(892686),b=i(487027),y=i(399890),L=i(73239),E=i(130551);function P(e){const t=JSON.parse(e.pp);var i;return(0,n.assert)("s"in(i=t)&&(0,E.isObject)(i.s)&&"l"in i.s&&"c"in i.s&&"e"in i&&(0,E.isObject)(i.e)&&"l"in i.e&&"c"in i.e,"unexpected log source"),{barTime:e.t,time:e.tms,level:e.ll,source:{start:{line:t.s.l,column:t.s.c},end:{line:t.e.l,column:t.e.c}},message:e.m}}function B(e){return{lines:e.l,time:e.t,invocations:e.c}}const D=!1;function z(e){return{total:e.total,profile:e.profile.map(B)}}var k=i(255866),N=i(408582);function C(e){return{...e}}var M=i(355468),V=i(515821);class R{constructor(e={}){this._indexes=[],this._hhistsByTimePointIndex=new Map,this._primitivesCollection=function(e){const t={};for(const i of M.primitiveNames){t[i]=new Map;const n=e[i];if(void 0!==n)for(const e in n)if(n.hasOwnProperty(e))switch(i){case"horizlines":t[i].set(e,G.horizlines());break;case"vertlines":t[i].set(e,G.vertlines());break;case"lines":t[i].set(e,G.lines());break;case"hlines":t[i].set(e,G.hlines());break;case"textmarks":t[i].set(e,G.textmarks());break;case"shapemarks":t[i].set(e,G.shapemarks());break;case"backgrounds":t[i].set(e,G.backgrounds());break;case"polygons":t[i].set(e,G.polygons());break;case"trendchannels":t[i].set(e,G.trendchannels());break;case"hhists":t[i].set(e,G.hhists());break;case"dwglabels":case"dwglines":case"dwgpolylines":case"dwgboxes":case"dwgtables":case"tpoBlockSets":case"tpoLevels":case"tpoVolumeRows":case"tpoSummaryInfo":t[i].set(e,new Map);break;case"dwgtablecells":t[i].set(e,G.dwgtablecells());break;case"dwglinefills":t[i].set(e,G.dwglinefills());break;case"tpos":t[i].set(e,G.tpos());break;case"logs":t[i].set(e,G.logs());break;case"footprints":t[i].set(e,G.footprints());break;case"footprintLevels":t[i].set(e,G.footprintLevels())}}t.performance.set("performance",new O(z,D));return t}(e)}horizlines(){return this._primitivesCollection.horizlines}vertlines(){return this._primitivesCollection.vertlines}lines(){return this._primitivesCollection.lines}hlines(){return this._primitivesCollection.hlines}textmarks(){return this._primitivesCollection.textmarks}shapemarks(){return this._primitivesCollection.shapemarks}backgrounds(){return this._primitivesCollection.backgrounds}polygons(){return this._primitivesCollection.polygons}trendchannels(){return this._primitivesCollection.trendchannels}hhists(){return this._primitivesCollection.hhists}dwglabels(){
return this._primitivesCollection.dwglabels}dwglines(){return this._primitivesCollection.dwglines}dwgpolylines(){return this._primitivesCollection.dwgpolylines}dwgboxes(){return this._primitivesCollection.dwgboxes}dwgtables(){return this._primitivesCollection.dwgtables}dwgtablecells(){return this._primitivesCollection.dwgtablecells}dwglinefills(){return this._primitivesCollection.dwglinefills}tpos(){return this._primitivesCollection.tpos}tpoBlockSets(){return this._primitivesCollection.tpoBlockSets}tpoLevels(){return this._primitivesCollection.tpoLevels}tpoVolumeRows(){return this._primitivesCollection.tpoVolumeRows}tpoSummaryInfo(){return this._primitivesCollection.tpoSummaryInfo}logs(){return this._primitivesCollection.logs}observableLogs(){return this._primitivesCollection.logs}performance(){return this._primitivesCollection.performance}observablePerformance(){return this._primitivesCollection.performance}footprints(){return this._primitivesCollection.footprints}footprintLevels(){return this._primitivesCollection.footprintLevels}hhistsByTimePointIndex(){return this._hhistsByTimePointIndex}clear(){this._indexes=[];for(const e of M.regularPrimitiveNames)this._primitivesCollection[e].forEach((e=>e.clear()));for(const e of M.groupedPrimitiveNames)this._primitivesCollection[e].forEach((e=>{e.forEach((e=>e.clear()))}));this._hhistsByTimePointIndex=new Map}extract(){const e={indexes:this._indexes,horizlines:A(this._primitivesCollection.horizlines),vertlines:A(this._primitivesCollection.vertlines),lines:A(this._primitivesCollection.lines),hlines:A(this._primitivesCollection.hlines),textmarks:A(this._primitivesCollection.textmarks),shapemarks:A(this._primitivesCollection.shapemarks),backgrounds:A(this._primitivesCollection.backgrounds),polygons:A(this._primitivesCollection.polygons),trendchannels:A(this._primitivesCollection.trendchannels),hhists:A(this._primitivesCollection.hhists),dwglabels:H(this._primitivesCollection.dwglabels),dwglines:H(this._primitivesCollection.dwglines),dwgpolylines:H(this._primitivesCollection.dwgpolylines),dwgboxes:H(this._primitivesCollection.dwgboxes),dwgtables:H(this._primitivesCollection.dwgtables),dwgtablecells:A(this._primitivesCollection.dwgtablecells),dwglinefills:A(this._primitivesCollection.dwglinefills),tpos:A(this._primitivesCollection.tpos),tpoBlockSets:H(this._primitivesCollection.tpoBlockSets),tpoLevels:H(this._primitivesCollection.tpoLevels),tpoVolumeRows:H(this._primitivesCollection.tpoVolumeRows),tpoSummaryInfo:H(this._primitivesCollection.tpoSummaryInfo),logs:new Map,performance:new Map,footprints:A(this._primitivesCollection.footprints),footprintLevels:A(this._primitivesCollection.footprintLevels)};return this._hhistsByTimePointIndex=new Map,new V.StaticStudyGraphics("data",e)}replaceIndexesTo(e){this._indexes=e;const t=e=>e.replaceIndexesTo(this._indexes);for(const e of M.regularPrimitiveNames)this._primitivesCollection[e].forEach(t);for(const e of M.groupedPrimitiveNames)this._primitivesCollection[e].forEach((e=>{e.forEach(t)}));this._hhistsByTimePointIndex=(0,
M.splitHHistsByTimePointIndex)(this._primitivesCollection.hhists)}processCommands(e){void 0!==e.erase&&this._processEraseCommands(e.erase),void 0!==e.create&&this._processCreateCommands(e.create)}_processCreateCommands(e){for(const t in e){if(!e.hasOwnProperty(t))continue;const i=t;switch(i){case"horizlines":X(this._indexes,this._primitivesCollection.horizlines,e[i]);break;case"vertlines":X(this._indexes,this._primitivesCollection.vertlines,e[i]);break;case"lines":X(this._indexes,this._primitivesCollection.lines,e[i]);break;case"hlines":X(this._indexes,this._primitivesCollection.hlines,e[i]);break;case"textmarks":X(this._indexes,this._primitivesCollection.textmarks,e[i]);break;case"shapemarks":X(this._indexes,this._primitivesCollection.shapemarks,e[i]);break;case"backgrounds":X(this._indexes,this._primitivesCollection.backgrounds,e[i]);break;case"polygons":X(this._indexes,this._primitivesCollection.polygons,e[i]);break;case"trendchannels":X(this._indexes,this._primitivesCollection.trendchannels,e[i]);break;case"hhists":X(this._indexes,this._primitivesCollection.hhists,e[i]);break;case"dwglabels":F(i,this._indexes,this._primitivesCollection.dwglabels,G.dwglabels,e[i]);break;case"dwglines":F(i,this._indexes,this._primitivesCollection.dwglines,G.dwglines,e[i]);break;case"dwgpolylines":F(i,this._indexes,this._primitivesCollection.dwgpolylines,G.dwgpolylines,e[i]);break;case"dwgboxes":F(i,this._indexes,this._primitivesCollection.dwgboxes,G.dwgboxes,e[i]);break;case"dwgtables":F(i,this._indexes,this._primitivesCollection.dwgtables,G.dwgtables,e[i]);break;case"dwgtablecells":X(this._indexes,this._primitivesCollection.dwgtablecells,e[i]);break;case"dwglinefills":X(this._indexes,this._primitivesCollection.dwglinefills,e[i]);break;case"tpos":X(this._indexes,this._primitivesCollection.tpos,e[i]);break;case"tpoBlockSets":F(i,this._indexes,this._primitivesCollection.tpoBlockSets,G.tpoBlockSets,e[i]);break;case"tpoLevels":F(i,this._indexes,this._primitivesCollection.tpoLevels,G.tpoLevels,e[i]);break;case"tpoVolumeRows":F(i,this._indexes,this._primitivesCollection.tpoVolumeRows,G.tpoVolumeRows,e[i]);break;case"tpoSummaryInfo":F(i,this._indexes,this._primitivesCollection.tpoSummaryInfo,G.tpoSummary,e[i]);break;case"logs":X(this._indexes,this._primitivesCollection.logs,e[i]);break;case"performance":X(this._indexes,this._primitivesCollection.performance,e[i]);break;case"footprints":X(this._indexes,this._primitivesCollection.footprints,e[i]);break;case"footprintLevels":X(this._indexes,this._primitivesCollection.footprintLevels,e[i])}}this._hhistsByTimePointIndex=(0,M.splitHHistsByTimePointIndex)(this._primitivesCollection.hhists)}_processEraseCommands(e){for(const t of e)if("all"===t.action){for(const e of M.regularPrimitiveNames)this._primitivesCollection[e].forEach((e=>e.clearPrimitives()));for(const e of M.groupedPrimitiveNames)this._primitivesCollection[e].forEach((e=>{e.forEach((e=>e.clearPrimitives()))}))}else{const e=e=>e.deleteById(t.id);(0,
M.isRegularPrimiriveName)(t.type)?this._primitivesCollection[t.type].forEach(e):this._primitivesCollection[t.type].forEach((t=>{t.forEach(e)}))}this._hhistsByTimePointIndex=(0,M.splitHHistsByTimePointIndex)(this._primitivesCollection.hhists)}}class O{constructor(e,t){this._primitivesDataById=new Map,this._primitiveById=new Map,this._changed=new s.Delegate,this._cleared=new s.Delegate,this._materializePrimitive=e,this._isRematerializationRequiredWithNewIndexes=t}changed(){return this._changed}cleared(){return this._cleared}forEach(e,t){this._primitiveById.forEach((i=>{e.call(t,i,i,this)}))}has(e){let t=!1;return this._primitiveById.forEach((i=>{t=t||i===e})),t}get size(){return this._primitiveById.size}[Symbol.iterator](){return this._primitiveById.values()}entries(){throw new Error("Not implemented")}keys(){throw new Error("Not implemented")}union(){throw new Error("Not implemented")}intersection(){throw new Error("Not implemented")}difference(){throw new Error("Not implemented")}symmetricDifference(){throw new Error("Not implemented")}isSubsetOf(){throw new Error("Not implemented")}isSupersetOf(){throw new Error("Not implemented")}isDisjointFrom(){throw new Error("Not implemented")}values(){return this._primitiveById.values()}hasId(e){return this._primitiveById.has(e)}addData(e,t){const i=[];e.forEach((e=>{this._primitivesDataById.set(e.id,e);const n=this._tryMaterialize(t,e);null!==n&&i.push(n)})),i.length>0&&this._changed.fire({created:i,removed:[]})}deleteById(e){const t=this._primitiveById.get(e);t&&(this._primitiveById.delete(e),this._primitivesDataById.delete(e),this._changed.fire({created:[],removed:[t]}))}clear(){this.clearPrimitives()}clearPrimitives(){this._primitivesDataById.clear(),this._primitiveById.clear(),this._cleared.fire()}replaceIndexesTo(e){if(!this._isRematerializationRequiredWithNewIndexes)return;const t=Array.from(this._primitiveById.values());this._primitiveById.clear(),this._primitivesDataById.forEach(this._tryMaterialize.bind(this,e),this);const i=Array.from(this._primitiveById.values());this._changed.fire({created:i,removed:t})}extract(){const e=new Set(this._primitivesDataById.values());return this.clearPrimitives(),e}_tryMaterialize(e,t){const i=this._materializePrimitive(t,e);return null!==i&&((0,n.assert)(!this._primitiveById.has(t.id),"primitive with specified id should not exist"),this._primitiveById.set(t.id,i)),i}}function S(e){const t=new Map;for(const[s,r]of e)t.set(s,(i=r,(n=t.get(s))?(0,o.join)(n,i.extract()):i.extract()));var i,n;return t}function A(e){return S((0,o.mapEntriesGenerator)(e))}function H(e){return S((0,o.nestedMapGenerator)(e))}function X(e,t,i=[]){for(const o of i){const i=o.styleId,s=t.get(i);(0,n.assert)(void 0!==s,"Every style used by graphics primitive should be declared in study metainfo"),s.addData(o.data,e)}}function F(e,t,i,o,s=[]){for(const r of s){const s=r.styleId,l=i.get(s);(0,n.assert)(void 0!==l,"Every style used by graphics primitive should be declared in study metainfo"),r.data.forEach((i=>{const n=(0,M.getPrimitiveDataKey)(i,e),s=l.get(n)??o()
;s.addData([i],t),l.set(n,s)}))}}const G={horizlines:()=>new O(l.materializeHorizLine,l.containsHorizLineTimePointIndexes),vertlines:()=>new O(a.materializeVertLine,a.containsVertLineTimePointIndexes),lines:()=>new O(I.materializeLine,I.containsLineTimePointIndexes),hlines:()=>new O(u.materializeLevel,u.containsLevelTimePointIndexes),textmarks:()=>new O(g.materializeTextMark,g.containsTextMarkTimePointIndexes),shapemarks:()=>new O(f.materializeShapeMark,f.containsShapeMarkTimePointIndexes),backgrounds:()=>new O(c.materializeBackground,c.containsBackgroundTimePointIndexes),polygons:()=>new O(d.materializePolygon,d.containsPolygonTimePointIndexes),trendchannels:()=>new O(w.materializeTrendChannel,w.containsTrendChannelTimePointIndexes),hhists:()=>new O(r.materializeHHist,r.containsHHistTimePointIndexes),dwglines:()=>new O(p.materializeDwgLine,p.containsDwgLineTimePointIndexes),dwglinefills:()=>new O(T.materializeDwgLineFill,T.containsDwgLineFillTimePointIndexes),dwglabels:()=>new O(h.materializeDwgLabel,h.containsDwgLabelTimePointIndexes),dwgtablecells:()=>new O(_.materializeDwgTableCell,_.containsDwgTableCellTimePointIndexes),dwgpolylines:()=>new O(m.materializeDwgPolyline,m.containsDwgPolylineTimePointIndexes),dwgboxes:()=>new O(x.materializeDwgBox,x.containsDwgBoxTimePointIndexes),dwgtables:()=>new O(_.materializeDwgTable,_.containsDwgTableTimePointIndexes),tpos:()=>new O(v.materializeTpo,v.containsTpoTimePointIndexes),tpoBlockSets:()=>new O(b.materializeTpoBlockSet,b.containsTpoBlockSetTimePointIndexes),tpoLevels:()=>new O(y.materializeTpoLevelGroup,y.containsTpoLevelGroupTimePointIndexes),tpoVolumeRows:()=>new O(L.materializeTpoVolumeRow,L.containsTpoVolumeRowTimePointIndexes),tpoSummary:()=>new O(C,false),logs:()=>new O(P,false),footprints:()=>new O(k.materializeVolumeFootprint,k.containsFootprintTimePointIndexes),footprintLevels:()=>new O(N.materializeVolumeFootprintPriceLevel,N.containsFootprintPriceLevelTimePointIndexes)}},239041:(e,t,i)=>{i.d(t,{containsPolygonTimePointIndexes:()=>s,dematerializePolygon:()=>l,isPolygonInBarsRange:()=>a,materializePolygon:()=>r});var n=i(501571),o=i(585240);const s=!0;function r(e,t){for(const i of e.points){if(i.index>=t.length)return null;if(t[i.index]===n.INVALID_TIME_POINT_INDEX)return null}return{points:e.points.map((e=>({index:t[e.index],offset:e.offset,level:e.level})))}}function l(e,t,i){return{id:t,points:e.points.map((e=>({...e,index:(0,o.ensureTimePointIndexIndex)(i.indexOf(e.index))})))}}function a(e,t){if(e.points.some((e=>t.contains(e.index+(e.offset??0)))))return!0;let i=!1,n=!1;const o=t.firstBar();for(const t of e.points)t.index+(t.offset??0)<o?i=!0:n=!0;return i&&n}},521854:(e,t,i)=>{i.d(t,{containsShapeMarkTimePointIndexes:()=>r,dematerializeShapeMark:()=>a,isShapeMarkInBarsRange:()=>d,materializeShapeMark:()=>l});var n,o=i(501571),s=i(585240);!function(e){e.Circle="circle",e.ArrowUp="arrowUp",e.ArrowDown="arrowDown",e.ArrowRight="arrowRight",e.ArrowLeft="arrowLeft",e.Square="square"}(n||(n={}));const r=!0;function l(e,t){if(e.time>=t.length)return null
;const i=t[e.time];return i===o.INVALID_TIME_POINT_INDEX?null:{time:i,price:e.price}}function a(e,t,i){const n=(0,s.ensureTimePointIndexIndex)(i.indexOf(e.time));return{id:t,...e,time:n}}function d(e,t){return t.contains(e.time)}},515821:(e,t,i)=>{i.d(t,{StaticStudyGraphics:()=>B,emptyStudyGraphics:()=>R,loadStudyGraphics:()=>O,saveStudyGraphics:()=>A});var n=i(501571),o=i(224621),s=i(267439),r=i(307801),l=i(239041),a=i(759214),d=i(951586),c=i(649420),h=i(521854),p=i(968632),m=i(323070),x=i(15141),u=i(164937),I=i(551789),f=i(18613),g=i(817959),w=i(276507),_=i(892686),T=i(487027),v=i(399890),b=i(73239),y=i(255866),L=i(408582),E=i(355468),P=i(124829);class B{constructor(e,t){if(this._indexes=[],this._horizlines=new Map,this._vertlines=new Map,this._lines=new Map,this._hlines=new Map,this._textmarks=new Map,this._shapemarks=new Map,this._backgrounds=new Map,this._polygons=new Map,this._trendchannels=new Map,this._hhists=new Map,this._dwglabels=new Map,this._dwglines=new Map,this._dwgpolylines=new Map,this._dwgboxes=new Map,this._dwgtables=new Map,this._dwgtablecells=new Map,this._dwglinefills=new Map,this._tpos=new Map,this._tpoBlockSets=new Map,this._tpoLevelGroups=new Map,this._tpoVolumeRows=new Map,this._tpoSummaryInfo=new Map,this._logs=new Map,this._performance=new Map,this._footprints=new Map,this._footprintLevels=new Map,"data"===e){const e=t;this._indexes=e.indexes,this._vertlines=D(e.vertlines,this._indexes,s.materializeVertLine),this._horizlines=D(e.horizlines,this._indexes,o.materializeHorizLine),this._polygons=D(e.polygons,this._indexes,l.materializePolygon),this._hhists=D(e.hhists,this._indexes,r.materializeHHist),this._backgrounds=D(e.backgrounds,this._indexes,a.materializeBackground),this._lines=D(e.lines,this._indexes,c.materializeLine),this._hlines=D(e.hlines,this._indexes,d.materializeLevel),this._textmarks=D(e.textmarks,this._indexes,p.materializeTextMark),this._shapemarks=D(e.shapemarks,this._indexes,h.materializeShapeMark),this._trendchannels=D(e.trendchannels,this._indexes,m.materializeTrendChannel),this._dwglabels=z("dwglabels",e.dwglabels,this._indexes,x.materializeDwgLabel),this._dwglines=z("dwglines",e.dwglines,this._indexes,u.materializeDwgLine),this._dwgpolylines=z("dwgpolylines",e.dwgpolylines,this._indexes,I.materializeDwgPolyline),this._dwgboxes=z("dwgboxes",e.dwgboxes,this._indexes,f.materializeDwgBox),this._dwgtables=z("dwgtables",e.dwgtables,this._indexes,g.materializeDwgTable),this._dwgtablecells=D(e.dwgtablecells,this._indexes,g.materializeDwgTableCell),this._dwglinefills=D(e.dwglinefills,this._indexes,w.materializeDwgLineFill),this._tpos=D(e.tpos,this._indexes,_.materializeTpo),this._tpoBlockSets=z("tpoBlockSets",e.tpoBlockSets,this._indexes,T.materializeTpoBlockSet),this._tpoVolumeRows=z("tpoVolumeRows",e.tpoVolumeRows,this._indexes,b.materializeTpoVolumeRow),this._tpoLevelGroups=z("tpoLevels",e.tpoLevels,this._indexes,v.materializeTpoLevelGroup),this._footprints=D(e.footprints,this._indexes,y.materializeVolumeFootprint),
this._footprintLevels=D(e.footprintLevels,this._indexes,L.materializeVolumeFootprintPriceLevel)}else if("state"===e){const e=t;this._indexes=e.indexes||[],this._vertlines=k(e.vertlines,this._indexes,s.materializeVertLine),this._horizlines=k(e.horizlines,this._indexes,o.materializeHorizLine),this._polygons=k(e.polygons,this._indexes,l.materializePolygon),this._hhists=k(e.hhists,this._indexes,r.materializeHHist),this._backgrounds=k(e.backgrounds,this._indexes,a.materializeBackground),this._lines=k(e.lines,this._indexes,c.materializeLine),this._hlines=k(e.hlines,this._indexes,d.materializeLevel),this._textmarks=k(e.textmarks,this._indexes,p.materializeTextMark),this._shapemarks=k(e.shapemarks,this._indexes,h.materializeShapeMark),this._trendchannels=k(e.trendchannels,this._indexes,m.materializeTrendChannel),this._dwglabels=N("dwglabels",e.dwglabels,this._indexes,x.materializeDwgLabel),this._dwglines=N("dwglines",e.dwglines,this._indexes,u.materializeDwgLine),this._dwgpolylines=N("dwgpolylines",e.dwgpolylines,this._indexes,I.materializeDwgPolyline),this._dwgboxes=N("dwgboxes",e.dwgboxes,this._indexes,f.materializeDwgBox),this._dwgtables=N("dwgtables",e.dwgtables,this._indexes,g.materializeDwgTable),this._dwgtablecells=k(e.dwgtablecells,this._indexes,g.materializeDwgTableCell),this._dwglinefills=k(e.dwglinefills,this._indexes,w.materializeDwgLineFill),this._tpos=k(e.tpos,this._indexes,_.materializeTpo),this._tpoBlockSets=N("tpoBlockSets",e.tpoBlockSets,this._indexes,T.materializeTpoBlockSet),this._tpoVolumeRows=N("tpoVolumeRows",e.tpoVolumeRows,this._indexes,b.materializeTpoVolumeRow),this._tpoLevelGroups=N("tpoLevels",e.tpoLevels,this._indexes,v.materializeTpoLevelGroup),this._footprints=k(e.footprints,this._indexes,y.materializeVolumeFootprint),this._footprintLevels=k(e.footprintLevels,this._indexes,L.materializeVolumeFootprintPriceLevel)}this._hhistsByTimePointIndex=(0,E.splitHHistsByTimePointIndex)(this._hhists)}horizlines(){return this._horizlines}vertlines(){return this._vertlines}lines(){return this._lines}hlines(){return this._hlines}textmarks(){return this._textmarks}shapemarks(){return this._shapemarks}backgrounds(){return this._backgrounds}polygons(){return this._polygons}trendchannels(){return this._trendchannels}hhists(){return this._hhists}dwglabels(){return this._dwglabels}dwglines(){return this._dwglines}dwgpolylines(){return this._dwgpolylines}dwgboxes(){return this._dwgboxes}dwgtables(){return this._dwgtables}dwgtablecells(){return this._dwgtablecells}dwglinefills(){return this._dwglinefills}tpos(){return this._tpos}tpoBlockSets(){return this._tpoBlockSets}tpoLevels(e){return this._tpoLevelGroups}tpoVolumeRows(e){return this._tpoVolumeRows}tpoSummaryInfo(e){return this._tpoSummaryInfo}logs(){return this._logs}performance(){return this._performance}footprints(){return this._footprints}footprintLevels(){return this._footprintLevels}hhistsByTimePointIndex(){return this._hhistsByTimePointIndex}}function D(e,t,i){
return new Map(Array.from(e.entries()).map((e=>[e[0],new Set(Array.from(e[1]).map((e=>i(e,t))).filter(P.notNull))])))}function z(e,t,i,n){const o=t=>{const i=new Map;return t.forEach((t=>{const n=(0,E.getPrimitiveKey)(t,e),o=i.get(n)??new Set;o.add(t),i.set(n,o)})),i};return new Map(Array.from(t.entries()).map((e=>[e[0],o(Array.from(e[1]).map((e=>n(e,i))).filter(P.notNull))])))}function k(e,t,i){const n=new Map;if(void 0===e)return n;for(const o of e){const e=o.styleId,s=n.get(e)||new Set;o.data.forEach((e=>{const n=i(e,t);null!==n&&s.add(n)})),n.set(e,s)}return n}function N(e,t,i,n){const o=t=>{const i=new Map;return t.forEach((t=>{const n=(0,E.getPrimitiveKey)(t,e),o=i.get(n)??new Set;o.add(t),i.set(n,o)})),i};return new Map((t??[]).map((e=>[e.styleId,o(e.data.map((e=>n(e,i))).filter(P.notNull))])))}function C(e,t,i){let n=null;for(const i of e)i.styleId===t&&(n=i);null===n&&(n={styleId:t,data:[]},e.push(n)),n.data.push(i)}function M(e,t,i,n,o,s){const r=[];return e.forEach(((e,l)=>{e.forEach((e=>{(null===o||n(e,o))&&C(r,l,s(e,t(e),i))}))})),r.length>0?r:void 0}function V(e,t,i,n,o,s){const r=[];return e.forEach(((e,l)=>{e.forEach((e=>{e.forEach((e=>{(null===o||n(e,o))&&C(r,l,s(e,t(e),i))}))}))})),r.length>0?r:void 0}function R(){return new B}function O(e){return new B("state",e)}function S(e,t){return!0}function A(e,t){const i=function(e){const t=new Set,i=e=>{null!=e&&t.add(e)};e.horizlines().forEach(((e,i)=>{e.forEach((e=>{t.add(e.startIndex??n.INVALID_TIME_POINT_INDEX),t.add(e.endIndex)}))})),e.vertlines().forEach(((e,i)=>{e.forEach((e=>{t.add(e.index)}))})),e.lines().forEach(((e,i)=>{e.forEach((e=>{t.add(e.startIndex),t.add(e.endIndex)}))})),e.textmarks().forEach(((e,i)=>{e.forEach((e=>{t.add(e.time)}))})),e.shapemarks().forEach(((e,i)=>{e.forEach((e=>{t.add(e.time)}))})),e.backgrounds().forEach(((e,i)=>{e.forEach((e=>{t.add(null!==e.start?e.start:n.INVALID_TIME_POINT_INDEX),t.add(e.stop)}))})),e.polygons().forEach(((e,i)=>{e.forEach((e=>{e.points.forEach((e=>{t.add(e.index)}))}))})),e.trendchannels().forEach(((e,i)=>{e.forEach((e=>{t.add(e.startIndex),t.add(e.endIndex)}))})),e.hhists().forEach(((e,i)=>{e.forEach((e=>{t.add(e.firstBarTime??n.INVALID_TIME_POINT_INDEX),t.add(e.lastBarTime)}))})),e.dwglabels().forEach((e=>{e.forEach((e=>{e.forEach((e=>{t.add(e.x)}))}))})),e.dwglines().forEach((e=>{e.forEach((e=>{e.forEach((e=>{t.add(e.x1??n.INVALID_TIME_POINT_INDEX),t.add(e.x2??n.INVALID_TIME_POINT_INDEX)}))}))})),e.dwgpolylines().forEach((e=>{e.forEach((e=>{e.forEach((e=>{for(const i of e.points)t.add(i.x??n.INVALID_TIME_POINT_INDEX)}))}))})),e.dwgboxes().forEach((e=>{e.forEach((e=>{e.forEach((e=>{t.add(e.left??n.INVALID_TIME_POINT_INDEX),t.add(e.right??n.INVALID_TIME_POINT_INDEX)}))}))})),e.tpos().forEach((e=>{e.forEach((e=>{t.add(e.firstBarTime),t.add(e.lastBarTime)}))})),e.tpoLevels().forEach((e=>{e.forEach((e=>{e.forEach((e=>{i(e.poorHighExtendTo),i(e.poorLowExtendTo),i(e.tpoPocExtendTo),(e.singleprints??[]).map((e=>e.extendTo)).map(i)}))}))})),e.footprints().forEach((e=>{e.forEach((e=>{t.add(e.index)}))})),
e.footprintLevels().forEach((e=>{e.forEach((e=>{t.add(e.startIndex),i(e.extendTo)}))}));const o=Array.from(t);return o.sort(((e,t)=>e-t)),o}(e),E={indexes:i};let B=0;const D=()=>++B,z=e=>e.id;E.vertlines=M(e.vertlines(),D,i,s.isVertLineInBarsRange,t,s.dematerializeVertLine),E.horizlines=M(e.horizlines(),D,i,o.isHorizLineInBarsRange,t,o.dematerializeHorizLine),E.polygons=M(e.polygons(),D,i,l.isPolygonInBarsRange,t,l.dematerializePolygon),E.hhists=M(e.hhists(),D,i,r.isHHistInBarsRange,t,r.dematerializeHHist),E.backgrounds=M(e.backgrounds(),D,i,a.isBackgroundInBarsRange,t,a.dematerializeBackground);{E.lines=M(e.lines(),D,i,c.isLineInBarsRange,t,c.dematerializeLine),E.hlines=M(e.hlines(),D,i,S,t,d.dematerializeLevel),E.textmarks=M(e.textmarks(),D,i,p.isTextMarkInBarsRange,t,p.dematerializeTextMark),E.shapemarks=M(e.shapemarks(),D,i,h.isShapeMarkInBarsRange,t,h.dematerializeShapeMark),E.trendchannels=M(e.trendchannels(),D,i,m.isTrendChannelInBarsRange,t,m.dematerializeTrendChannel),E.dwglabels=V(e.dwglabels(),D,i,x.isDwgLabelInBarsRange,t,x.dematerializeDwgLabel),E.dwglines=V(e.dwglines(),z,i,u.isDwgLineInBarsRange,t,u.dematerializeDwgLine),E.dwgpolylines=V(e.dwgpolylines(),z,i,I.isDwgPolylineInBarsRange,t,I.dematerializeDwgPolyline),E.dwgboxes=V(e.dwgboxes(),D,i,f.isDwgBoxInBarsRange,t,f.dematerializeDwgBox),E.dwgtables=V(e.dwgtables(),z,i,S,t,g.dematerializeDwgTable),E.dwgtablecells=M(e.dwgtablecells(),D,i,S,t,g.dematerializeDwgTableCell),E.dwglinefills=M(e.dwglinefills(),D,i,S,t,w.dematerializeDwgLineFill);const n=new Map(Array.from(e.tpos().get("tpo")?.values()??[]).map((e=>[e.id,e]))),o=e=>n.get(e),s=V(e.tpoBlockSets(),D,i,T.isTpoBlockSetInBarsRange.bind(null,o),t,T.dematerializeTpoBlockSet);E.tpoLevels=V(e.tpoLevels(),D,i,v.isTpoLevelInBarsRange.bind(null,o),t,v.dematerializeTpoLevelGroup),E.tpoVolumeRows=V(e.tpoVolumeRows(),D,i,b.isTpoVolumeRowsInBarsRange.bind(null,o),t,b.dematerializeTpoVolumeRow);const r=[s?.[0].data,E.tpoLevels?.[0].data,E.tpoVolumeRows?.[0].data].filter(P.notUndefined).reduce(((e,t)=>e.concat(t.map((e=>e.tpoId)))),[]),l=new Set(r);E.tpos=M(e.tpos(),z,i,(e=>l.has(e.id)),t,_.dematerializeTpo),E.tpoBlockSets=V(e.tpoBlockSets(),D,i,(e=>l.has(e.tpoId)),t,T.dematerializeTpoBlockSet),E.footprints=M(e.footprints(),D,i,y.isVolumeFootprintInBarsRange,t,y.dematerializeVolumeFootprint),E.footprintLevels=M(e.footprintLevels(),D,i,L.isVolumeFootprintPriceLevelInBarsRange,t,L.dematerializeVolumeFootprintPriceLevel)}return E}},355468:(e,t,i)=>{i.d(t,{getPrimitiveDataKey:()=>c,getPrimitiveKey:()=>d,groupedPrimitiveNames:()=>p,hasForceOverlayPrimitives:()=>g,isRegularPrimiriveName:()=>x,isStudyGraphicsEmpty:()=>I,primitiveNames:()=>m,primitivesZOrders:()=>u,regularPrimitiveNames:()=>h,splitHHistsByTimePointIndex:()=>f});const n=["dwglines","dwgboxes","dwglabels","dwgpolylines","dwgtables"],o=e=>!!e.fo,s=e=>!!e.forceOverlay,r=e=>e.tpoId,l=e=>e.tpoId;function a(e){return n.includes(e)}function d(e,t){return a(t)?s(e):l(e)}function c(e,t){return a(t)?o(e):r(e)}
const h=["horizlines","vertlines","lines","hlines","textmarks","shapemarks","backgrounds","polygons","trendchannels","hhists","dwgtablecells","dwglinefills","tpos","logs","performance","footprints","footprintLevels"],p=n.concat(["tpoBlockSets","tpoLevels","tpoVolumeRows","tpoSummaryInfo"]),m=h.concat(p);function x(e){return h.includes(e)}const u=new Map([["logs",-4],["performance",-4],["polygons",-4],["trendchannels",-3],["textmarks",-2],["shapemarks",-2],["backgrounds",-1],["footprints",1],["footprintLevels",1],["hlines",1],["horizlines",1],["hhists",1],["dwglinefills",2],["vertlines",3],["lines",3],["dwglines",3],["dwgpolylines",3],["dwgboxes",4],["dwglabels",5],["dwgtables",6],["dwgtablecells",6],["tpos",7],["tpoBlockSets",7],["tpoLevels",7],["tpoVolumeRows",7],["tpoSummaryInfo",1]]);function I(e){return!m.some((t=>{const i=e[t]();for(const[,e]of i)if(e.size>0)return!0;return!1}))}function f(e){const t=new Map;return e.forEach(((e,i)=>{e.forEach((e=>{const n={...e,styleId:i},o=e.firstBarTime;let s=t.get(o);void 0===s&&(s=new Set,t.set(o,s)),s.add(n)}))})),t}function g(e){return!!(e.graphics.dwglines||e.graphics.dwgboxes||e.graphics.dwglabels||e.graphics.dwgpolylines||e.graphics.dwgtables)}},968632:(e,t,i)=>{i.d(t,{TextMarkType:()=>n,containsTextMarkTimePointIndexes:()=>l,dematerializeTextMark:()=>d,isTextMarkInBarsRange:()=>c,materializeTextMark:()=>a});var n,o,s=i(501571),r=i(585240);!function(e){e.Triangle="triangle",e.Rectangle="rectangle"}(n||(n={})),function(e){e.Verdana="Verdana",e.CourierNew="Courier New",e.TimesNewRoman="Times New Roman",e.Arial="Arial"}(o||(o={}));const l=!0;function a(e,t){if(e.time>=t.length)return null;const i=t[e.time];return i===s.INVALID_TIME_POINT_INDEX?null:{time:i,offset:e.offset,text:e.text,price:e.price}}function d(e,t,i){const n=(0,r.ensureTimePointIndexIndex)(i.indexOf(e.time));return{id:t,...e,time:n}}function c(e,t){return t.contains(e.time+(e.offset??0))}},487027:(e,t,i)=>{i.d(t,{containsTpoBlockSetTimePointIndexes:()=>o,dematerializeTpoBlockSet:()=>r,isTpoBlockSetInBarsRange:()=>l,materializeTpoBlockSet:()=>s});var n=i(892686);const o=!1;function s(e,t){return{tpoId:e.tpoId,blocks:e.blocks,rowIndex:e.rowIndex}}function r(e,t,i){return{id:t,tpoId:e.tpoId,blocks:e.blocks,rowIndex:e.rowIndex}}function l(e,t,i){const o=e(t.tpoId);return Boolean(o&&(0,n.isTpoInBarsRange)(o,i))}},399890:(e,t,i)=>{i.d(t,{containsTpoLevelGroupTimePointIndexes:()=>r,dematerializeTpoLevelGroup:()=>h,isTpoLevelInBarsRange:()=>p,materializeTpoLevelGroup:()=>a});var n=i(124829),o=i(501571),s=i(585240);const r=!0;function l(e,t){const i=null==e?e:t[e];return i===o.INVALID_TIME_POINT_INDEX?null:i}function a(e,t){return{tpoId:e.tpoId,tpoPocIndex:e.tpoPocIndex,tpoPocExtendTo:l(e.tpoPocExtendTo,t),tpoValIndex:e.tpoValIndex,tpoValExtendTo:l(e.tpoValExtendTo,t),tpoVahIndex:e.tpoVahIndex,tpoVahExtendTo:l(e.tpoVahExtendTo,t),tpoMidpointIndex:e.tpoMidpointIndex,volumePocIndex:e.volumePocIndex,volumePocExtendTo:l(e.volumePocExtendTo,t),volumeValIndex:e.volumeValIndex,volumeValExtendTo:l(e.volumeValExtendTo,t),
volumeVahIndex:e.volumeVahIndex,volumeVahExtendTo:l(e.volumeVahExtendTo,t),poorHighIndex:e.poorHighIndex,poorHighExtendTo:l(e.poorHighExtendTo,t),poorLowIndex:e.poorLowIndex,poorLowExtendTo:l(e.poorLowExtendTo,t),singleprints:e.singleprints?.map((e=>function(e,t){return{index:e.index,extendTo:l(e.extendTo,t)}}(e,t)))}}function d(e,t){return null==e?e:(0,s.ensureTimePointIndexIndex)(t.indexOf(e))}function c(e){return Object.keys(e).filter((t=>void 0===e[t])).forEach((t=>delete e[t])),e}function h(e,t,i){return c({id:t,tpoId:e.tpoId,tpoPocIndex:e.tpoPocIndex,tpoPocExtendTo:d(e.tpoPocExtendTo,i),tpoValIndex:e.tpoValIndex,tpoValExtendTo:d(e.tpoValExtendTo,i),tpoVahIndex:e.tpoVahIndex,tpoVahExtendTo:d(e.tpoVahExtendTo,i),tpoMidpointIndex:e.tpoMidpointIndex,volumePocIndex:e.volumePocIndex,volumePocExtendTo:d(e.volumePocExtendTo,i),volumeValIndex:e.volumeValIndex,volumeValExtendTo:d(e.volumeValExtendTo,i),volumeVahIndex:e.volumeVahIndex,volumeVahExtendTo:d(e.volumeVahExtendTo,i),poorHighIndex:e.poorHighIndex,poorHighExtendTo:d(e.poorHighExtendTo,i),poorLowIndex:e.poorLowIndex,poorLowExtendTo:d(e.poorLowExtendTo,i),singleprints:e.singleprints?.map((e=>function(e,t){return c({index:e.index,extendTo:d(e.extendTo,t)})}(e,i)))})}function p(e,t,i){const o=e(t.tpoId);if(!o)return!1;const s=o.firstBarTime,r=[t.poorHighExtendTo,t.poorLowExtendTo,t.tpoPocExtendTo,t.tpoValExtendTo,t.tpoVahExtendTo,t.volumePocExtendTo,t.volumeValExtendTo,t.volumeVahExtendTo].concat((t.singleprints??[]).map((e=>e.extendTo))).filter(n.notUndefined).map((e=>e??1/0));return!(((r.length?Math.max(...r):null)??o.lastBarTime)<i.firstBar()||s>i.lastBar())}},73239:(e,t,i)=>{i.d(t,{containsTpoVolumeRowTimePointIndexes:()=>o,dematerializeTpoVolumeRow:()=>r,isTpoVolumeRowsInBarsRange:()=>l,materializeTpoVolumeRow:()=>s});var n=i(892686);const o=!1;function s(e,t){return{tpoId:e.tpoId,rowIndex:e.rowIndex,volume:e.volume}}function r(e,t,i){return{id:t,tpoId:e.tpoId,rowIndex:e.rowIndex,volume:e.volume}}function l(e,t,i){const o=e(t.tpoId);return Boolean(o&&(0,n.isTpoInBarsRange)(o,i))}},323070:(e,t,i)=>{i.d(t,{containsTrendChannelTimePointIndexes:()=>r,dematerializeTrendChannel:()=>a,isTrendChannelInBarsRange:()=>d,materializeTrendChannel:()=>l});var n=i(650151),o=i(501571),s=i(585240);const r=!0;function l(e,t){if(e.startIndex>=t.length||e.endIndex>=t.length)return null;const i=t[e.startIndex],s=t[e.endIndex];return i===o.INVALID_TIME_POINT_INDEX||s===o.INVALID_TIME_POINT_INDEX?null:((0,n.assert)(i<=s,"startIndex should not exceed endIndex"),{startIndex:i,endIndex:s,extendLeft:e.extendLeft,extendRight:e.extendRight,startHighPrice:e.startHighPrice,startLowPrice:e.startLowPrice,endHighPrice:e.endHighPrice,transparency:e.transparency})}function a(e,t,i){const n=(0,s.ensureTimePointIndexIndex)(i.indexOf(e.startIndex)),o=(0,s.ensureTimePointIndexIndex)(i.indexOf(e.endIndex));return{id:t,...e,startIndex:n,endIndex:o}}function d(e,t){const i=Math.min(e.startIndex,e.endIndex),n=Math.max(e.startIndex,e.endIndex)
;if(t.contains(i)||t.contains(n)||i<t.firstBar()&&n>t.lastBar())return!0;const o=e.startIndex<e.endIndex?e.extendLeft:e.extendRight,s=e.startIndex<e.endIndex?e.extendRight:e.extendLeft;return n<t.firstBar()&&s||i>t.lastBar()&&o}},267439:(e,t,i)=>{i.d(t,{containsVertLineTimePointIndexes:()=>s,dematerializeVertLine:()=>l,isVertLineInBarsRange:()=>a,materializeVertLine:()=>r});var n=i(501571),o=i(585240);const s=!0;function r(e,t){if(e.index>=t.length)return null;const i=t[e.index];return i===n.INVALID_TIME_POINT_INDEX?null:{startPrice:e.startPrice,endPrice:e.endPrice,index:i,extendTop:e.extendTop,extendBottom:e.extendBottom}}function l(e,t,i){const n=(0,o.ensureTimePointIndexIndex)(i.indexOf(e.index));return{id:t,...e,index:n}}function a(e,t){return t.contains(e.index)}},408582:(e,t,i)=>{i.d(t,{containsFootprintPriceLevelTimePointIndexes:()=>s,dematerializeVolumeFootprintPriceLevel:()=>l,isVolumeFootprintPriceLevelInBarsRange:()=>a,materializeVolumeFootprintPriceLevel:()=>r});var n=i(501571),o=i(585240);const s=!0;function r(e,t){if(e.startIndex>=t.length)return null;const i=t[e.startIndex],o=null===e.extendTo?null:t[e.extendTo];return i===n.INVALID_TIME_POINT_INDEX||o===n.INVALID_TIME_POINT_INDEX?null:{id:e.id,price:e.price,type:e.type,startIndex:i,extendTo:o}}function l(e,t,i){const s=(0,o.ensureTimePointIndexIndex)(i.indexOf(e.startIndex??n.INVALID_TIME_POINT_INDEX)),r=null===e.extendTo?null:(0,o.ensureTimePointIndexIndex)(i.indexOf(e.extendTo??n.INVALID_TIME_POINT_INDEX));return{id:t,price:e.price,type:e.type,startIndex:s,extendTo:r}}function a(e,t){const i=e.startIndex;return!((e.extendTo??1/0)<t.firstBar()||i>t.lastBar())}},984217:(e,t,i)=>{function n(e){const t=new Map;return e.plots.forEach(((e,i)=>{t.set(e.id,(e=>e[i+1]))})),t}function o(e,t){return null==e[t]}i.d(t,{studyEmptyPlotValuePredicate:()=>o,studyPlotFunctionMap:()=>n})}}]);
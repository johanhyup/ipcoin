"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[45997],{86e3:(t,e,i)=>{var s;i.d(e,{PaneCursorType:()=>s}),function(t){t[t.Default=0]="Default",t[t.Pointer=1]="Pointer",t[t.Eraser=2]="Eraser",t[t.Dot=3]="Dot",t[t.Grabbing=4]="Grabbing",t[t.ZoomIn=5]="ZoomIn",t[t.VerticalResize=6]="VerticalResize",t[t.HorizontalResize=7]="HorizontalResize",t[t.DiagonalNeSwResize=8]="DiagonalNeSwResize",t[t.DiagonalNwSeResize=9]="DiagonalNwSeResize",t[t.Text=10]="Text"}(s||(s={}))},95370:(t,e,i)=>{i.d(e,{PanePriceAxisView:()=>a});var s=i(5486);class n{constructor(t){this._priceAxisViewRenderer=null,this._rendererOptions=null,this._align="right",this._textWidthCache=t}setParams(t,e,i,s,n){this._priceAxisViewRenderer=t,this._rendererOptions=e,this._align=n}draw(t,e){null!==this._rendererOptions&&null!==this._priceAxisViewRenderer&&this._priceAxisViewRenderer.draw(t,e,this._rendererOptions,this._textWidthCache,this._align)}hitTest(t,e){return void 0===this._priceAxisViewRenderer?.hitTest?null:this._priceAxisViewRenderer?.hitTest(t,e,this._align)}}class a{constructor(t,e,i){this._renderer=null,this._invalidated=!0,this._priceAxisView=t,this._textWidthCache=new s.TextWidthCache(100),this._dataSource=e,this._chartModel=i,this._fontSize=-1,this._panePriceAxisViewRenderer=new n(this._textWidthCache)}update(t){this._invalidated=!0}renderer(t){return this._invalidated&&this._updateImpl(t),this._renderer}_position(){const t=this._chartModel.crossHairSource(),e=this._dataSource===t?t.pane:this._chartModel.paneForSource(this._dataSource);if(null===e)return null;const i=this._priceScale();if(null===i)return null;let s=e.priceScalePosition(i);return"overlay"===s&&(s=e.priceScalePosition(e.defaultPriceScale())),"overlay"===s?null:s}_updateImpl(t){this._renderer=null;const e=this._position();if(null===e)return;const i=this._chartModel.priceAxisRendererOptions();i.fontSize!==this._fontSize&&(this._fontSize=i.fontSize,this._textWidthCache.reset()),this._panePriceAxisViewRenderer.setParams(this._priceAxisView.paneRenderer(),i,t.mediaSize.width,t.mediaSize.height,e),this._renderer=this._panePriceAxisViewRenderer,this._invalidated=!1}_priceScale(){return this._dataSource.priceScale()}}},403862:(t,e,i)=>{i.d(e,{PaneRendererArea:()=>l});var s=i(708698),n=i(286436),a=i(665798);class l extends s.PaneRendererLine{constructor(t){t.forceLineColor=!1,super(t)}_drawImpl(t){const e=this._data;if(0===e.items.length)return;let i=this._data.visibleItemsRange?.startItemIndex??0,l=(this._data.visibleItemsRange?.endItemIndex??this._data.items.length)-1;for(;i<l&&!(0,n.coordinateIsValid)(e.items[i].y);)i++;for(;l>=0&&!(0,n.coordinateIsValid)(e.items[l].y);)l--;if(i>l)return;const{context:r,horizontalPixelRatio:o,verticalPixelRatio:d}=t;r.save(),r.scale(o,d),r.lineCap="round",r.strokeStyle=e.lineColor,r.lineWidth=e.lineWidth,(0,a.setLineStyle)(r,e.lineStyle),r.lineWidth=1;const h={},c=new s.PaneRendererLineItemsIterator(this._data.items,i,l+1,this._data.skipHoles);for(;c.next();){const t=c.currentValue();let i;i=(0,
s.isValidPoint)(t)&&t.style?t.style.color:e.lineColor;const n=c.nextValue();if((0,s.isValidPoint)(n)&&n?.style){const e=n.style.color;if(i!==e){const i=h[e]||[];i.push(t),h[e]=i}}const a=h[i]||[];a.push(t),h[i]=a}for(const t of Object.keys(h)){const i=h[t];r.beginPath();let n=0;for(let a=0;a<i.length;a++){const l=i[a];(0,s.isValidPoint)(l)&&(l.style&&l.style?.color!==t&&(r.moveTo(Math.round(i[n].center),e.bottom),this._walkLine(r,i.slice(n,a),!0,e.bottom,!0),n=a))}if(r.moveTo(Math.round(i[n].center),e.bottom),this._walkLine(r,i.slice(n,i.length),!0,e.bottom,!0),r.closePath(),e.isSeries){const t=r.createLinearGradient(0,0,0,e.bottom);t.addColorStop(0,e.color1),t.addColorStop(1,e.color2),r.fillStyle=t,e.simpleMode=!0}else r.fillStyle=t;r.fill()}r.lineWidth=e.lineWidth,r.restore(),super._drawImpl(t)}}},708698:(t,e,i)=>{i.d(e,{PaneRendererLine:()=>_,PaneRendererLineItemsIterator:()=>u,isValidPoint:()=>c});var s=i(650151),n=i(86441),a=i(204652),l=i(509078),r=i(286436),o=i(665798),d=i(961970);const h={y:NaN};function c(t){return null!==t&&!isNaN(t.y)}class u{constructor(t,e,i,n){this._calculatedPrev={index:null,currentBreakProcessed:!1,value:null},this._calculatedCurrent={index:null,currentBreakProcessed:!1,value:null},this._calculatedNext={index:null,currentBreakProcessed:!1,value:null},this._preallocatedVariable={index:null,currentBreakProcessed:!1,value:null},t.length&&((0,s.assert)(e<=i,"First index must be less or equal to last index"),(0,s.assert)(e<t.length,"First index must be less then array length"),(0,s.assert)(i<=t.length,"Last index must be less or equal to array length")),this._items=t,this._firstIndexWithRange=e,this._lastIndexWithRange=i,this._skipHoles=n}next(){if(0===this._items.length)return!1;if(null!==this._calculatedNext.index)return null!==this._calculatedNext.value&&(this._calculatedPrev=this._calculatedCurrent,this._calculatedCurrent=this._calculatedNext,this._calculatedNext={index:null,currentBreakProcessed:!1,value:null},!0);let t;this._preallocatedVariable={...this._calculatedCurrent};do{null===this._preallocatedVariable.index?(this._preallocatedVariable.index=this._firstIndexWithRange,this._preallocatedVariable.currentBreakProcessed=!1,t=this._preallocatedVariable.index<this._lastIndexWithRange):(this._incrementPointer(this._preallocatedVariable),t=this._isValidPointer(this._preallocatedVariable)),t&&this._calcVaue(this._preallocatedVariable)}while(t&&this._skipHoles&&!c(this._preallocatedVariable.value));return t&&(this._calculatedPrev=this._calculatedCurrent,this._calculatedCurrent=this._preallocatedVariable,this._calculatedNext={index:null,currentBreakProcessed:!1,value:null}),t}prevValue(){return this._calculatedPrev.value}currentValue(){return(0,s.ensureNotNull)(this._calculatedCurrent.value)}currentValueIsLast(){return(0,s.ensureNotNull)(this._calculatedCurrent.index)===this._items.length-1}currentValueIsFirst(){return 0===(0,s.ensureNotNull)(this._calculatedCurrent.index)}nextValue(){if(null!==this._calculatedNext.index)return this._calculatedNext.value;let t;this._calculatedNext={
...this._calculatedCurrent,value:null};do{this._incrementPointer(this._calculatedNext),t=this._isValidPointer(this._calculatedNext),t?this._calcVaue(this._calculatedNext):this._calculatedNext.value=null}while(t&&this._skipHoles&&!c(this._calculatedNext.value));return this._calculatedNext.value}atStart(){return this._calculatedCurrent.index===this._firstIndexWithRange&&!this._calculatedCurrent.currentBreakProcessed}atEnd(){const t=(0,s.ensureNotNull)(this._calculatedCurrent.index);return t<this._lastIndexWithRange&&(this._calculatedCurrent.currentBreakProcessed||!this._needBreakBefore(t))}_needBreakBefore(t){return!!this._items[t].breakBefore&&!this._skipHoles}_calcVaue(t){const e=(0,s.ensureNotNull)(t.index);this._needBreakBefore(e)&&!t.currentBreakProcessed?t.value=h:t.value=this._items[e]}_incrementPointer(t){const e=(0,s.ensureNotNull)(t.index);this._needBreakBefore(e)&&!this._calculatedCurrent.currentBreakProcessed?t.currentBreakProcessed=!0:(t.index=e+1,t.currentBreakProcessed=!1)}_isValidPointer(t){const e=(0,s.ensureNotNull)(t.index);return e<this._lastIndexWithRange||e===this._lastIndexWithRange-1&&this._needBreakBefore(e)&&t.currentBreakProcessed}}class _ extends d.BitmapCoordinatesPaneRenderer{constructor(t){super(),this._data=t}hitTest(t){const e=(0,r.interactionTolerance)().series+this._data.lineWidth/2;let i=this._data.visibleItemsRange?.startItemIndex??0,s=(this._data.visibleItemsRange?.endItemIndex??this._data.items.length)-1;for(;s-i>2;){const e=Math.round((s+i)/2);this._data.items[e].center<=t.x?i=e:s=e}i=Math.max(1,i-1),s=Math.min(this._data.items.length-1,s+1);for(let r=i;r<=s;++r){const i=this._data.items[r-1],s=this._data.items[r],o=i.center,d=s.center;if((0,a.distanceToSegment)(new n.Point(o,i.y),new n.Point(d,s.y),new n.Point(t.x,t.y)).distance<=e)return this._data.hittest?this._data.hittest:new l.HitTestResult(l.HitTarget.Regular)}return null}_drawImpl(t){const{context:e,horizontalPixelRatio:i,verticalPixelRatio:s}=t;e.scale(i,s),e.lineCap="round",e.lineJoin="round",e.strokeStyle=this._data.lineColor,e.fillStyle=this._data.lineColor,e.lineWidth=this._data.lineWidth,(0,o.setLineStyle)(e,this._data.lineStyle),(0,r.setValidLineStyle)(e,this._data.lineStyle),this._data.simpleMode?this._drawSimpleMode(e,i,s):this._drawLines(e)}_drawSimpleMode(t,e,i){t.beginPath(),this._walkLine(t,this._data.items,!1,NaN),t.stroke();const s=this._data.lineWidth+2;if(this._data.withMarkers&&2*s<this._data.barSpacing){t.scale(1/e,1/i);const n=Math.max(1,Math.floor(e))%2/2,a=s*i+n,l=2*Math.PI;t.beginPath();const r=this._data.visibleItemsRange?.startItemIndex??0;for(let s=(this._data.visibleItemsRange?.endItemIndex??this._data.items.length)-1+1;s-- >=r;){const r=this._data.items[s];if(r){const s=Math.round(r.center*e)+n,o=r.y*i;t.moveTo(s,o),t.arc(s,o,a,0,l)}}t.fill()}}_walkLine(t,e,i,s,n){if(!e)return;const a=.25*this._data.barSpacing;let l,r,o=null;const d=n?0:this._data.visibleItemsRange?.startItemIndex??0,h=n?e.length:Math.min(this._data.visibleItemsRange?.endItemIndex??e.length,e.length);if(d>h||d>=e.length)return
;const _=new u(e,d,h,this._data.skipHoles);for(;_.next();){if(l=_.currentValue(),r=_.nextValue(),c(l)){const e=Math.round(l.center);o&&c(o)?(t.lineTo(e,l.y),i&&!c(r)&&t.lineTo(e,s)):r&&c(r)?i?(_.atStart()||t.lineTo(e,s),t.lineTo(e,l.y)):t.moveTo(e,l.y):i?(_.atStart()||t.lineTo(e-a,s),t.lineTo(e-a,l.y),t.lineTo(e+a,l.y),t.lineTo(e+a,s)):(t.moveTo(e-a,l.y),t.lineTo(e+a,l.y))}o=l}}_drawLines(t){if(!this._data.items.length)return;let e,i,s=null;const n=.25*this._data.barSpacing;t.beginPath();const a=this._data.visibleItemsRange?.startItemIndex??0,l=this._data.visibleItemsRange?.endItemIndex??this._data.items.length;if(a>l||a>=this._data.items.length)return;const o=this._data.items[a];o&&t.moveTo(o.center,o.y);let d,h=t.strokeStyle,_=t.lineWidth;const m=new u(this._data.items,a,l,this._data.skipHoles);for(;m.next();){let a,l,o;s=m.prevValue(),e=m.currentValue(),i=m.nextValue();let u=!1;if(c(e)&&(e.style&&!this._data.forceLineColor?(a=e.style.color,l=e.style.width,o=e.style.style):(a=this._data.lineColor,l=this._data.lineWidth,o=this._data.lineStyle),this._data.ignorePaletteLineWidth&&(l=this._data.lineWidth),u=a!==h||l!==_||o!==d),u)if(h=a,_=l,d=o,t.stroke(),t.beginPath(),t.strokeStyle=a,t.lineWidth=l,(0,r.setValidLineStyle)(t,o),c(s))t.moveTo(s.center,s.y);else{const i=e;t.moveTo(i.center,i.y)}p=s,y=i,c(f=e)&&(c(p)?t.lineTo(f.center,f.y):y&&c(y)?t.moveTo(f.center,f.y):(t.moveTo(f.center-n,f.y),t.lineTo(f.center+n,f.y)))}var p,f,y;t.stroke()}}},810873:(t,e,i)=>{i.d(e,{PaneRendererStepLine:()=>f,StepLineDecoration:()=>s});var s,n=i(204652),a=i(86441),l=i(432059),r=i(509078),o=i(286436),d=i(665798),h=i(961970),c=i(708698);!function(t){t[t.None=0]="None",t[t.Diamonds=1]="Diamonds"}(s||(s={}));class u{constructor(t){this._forceExtendFirstBar=!!t}initialize(t,e,i){const{context:s,horizontalPixelRatio:n,verticalPixelRatio:a}=e,l=t.lineStyle;s.lineCap="butt",s.lineJoin="round";const r=Math.max(Math.floor(i.style?.width??t.lineWidth*n));void 0!==l&&(0,d.setLineStyle)(s,l);const o=r%2?.5:0;s.moveTo(Math.round(i.center*n)+o,Math.round(i.y*a)+o),s.strokeStyle=i.style?.color??t.lineColor,s.lineWidth=r}startFragment(t,e,i,s){t.beginPath();const n=i.firstItem&&i.extendToBarsEndings?e.center:e.left;t.moveTo(isNaN(n)?-50:n,e.y)}finishFragment(t,e,i){e&&i&&t.lineTo(e.left,i.y),t.stroke()}hitTest(t,e,i,s){if(!(0,c.isValidPoint)(e))return!1;const l=e.style?.width??t.lineWidth,r=(0,o.interactionTolerance)().series+l/2,{left:d,y:h}=e,u=isNaN(d)?-50:d;let _,m;return i&&(0,c.isValidPoint)(i)?(_=i.left,m=i.y):(_=e.right,m=e.y),!(u<s.x-r&&_<s.x-r||u>s.x+r&&_>s.x+r)&&((0,n.distanceToSegment)((0,a.point)(u,h),(0,a.point)(_,h),s).distance<r||h!==m&&(0,n.distanceToSegment)((0,a.point)(_,h),(0,a.point)(_,m),s).distance<r)}applyColor(t,e){t.strokeStyle=e}applyLineWidth(t,e){t.lineWidth=e}drawItem(t,e,i,s){const n=t.context;void 0!==s&&n.lineTo(e.left,s.y),n.lineTo(!i.firstItem||i.extendToBarsEndings||this._forceExtendFirstBar?e.left:e.center,e.y),n.lineTo(i.lastItem&&!i.extendToBarsEndings?e.center:e.right,e.y)}}class _{constructor(){this._lineWidth=1}
initialize(t,e,i){const{context:s,horizontalPixelRatio:n}=e;this.applyColor(s,i.style?.color??t.lineColor),this._lineWidth=Math.max(Math.floor(i.style?.width??t.lineWidth*n))}startFragment(t,e,i,s){t.beginPath()}finishFragment(t){t.fill()}drawItem(t,e,i,s){if(i.valIsNotSameAsPrev&&!isNaN(e.left)){const i=t.context;i.save(),i.translate(e.left,e.y),i.rotate(Math.PI/4);const s=this._scaleByLineWidth(this._lineWidth);i.scale(s,s),this._drawItemRotatedAndTranslated(t),i.restore()}}applyLineWidth(t,e){this._lineWidth=e}hitTest(t,e,i,s){if(!e.valIsNotSameAsPrev)return!1;const n=s.subtract((0,a.point)(e.left,e.y));return this._hitTestTranslated(n,e.style?.width??t.lineWidth)}_scaleByLineWidth(t){return Math.sqrt(t)}}class m extends _{applyColor(t,e){t.fillStyle=e}_hitTestTranslated(t,e){return Math.abs(t.x)+Math.abs(t.y)<8*this._scaleByLineWidth(e)/2}_drawItemRotatedAndTranslated(t){(0,d.drawRoundRect)(t.context,-4,-4,8,8,2,!0)}}class p extends _{applyColor(t,e){t.fillStyle=(0,l.applyTransparency)(e,85)}_hitTestTranslated(t,e){return Math.abs(t.x)+Math.abs(t.y)<21*this._scaleByLineWidth(e)/2}_drawItemRotatedAndTranslated(t){(0,d.drawRoundRect)(t.context,-10.5,-10.5,21,21,5,!0)}}class f extends h.BitmapCoordinatesPaneRenderer{constructor(t){super(),this._data=null,this._data=t??null}setData(t){this._data=t}hitTest(t){const e=this._data;if(null===e||0===e.items.length)return null;const{items:i,visibleItemsRange:n,skipHoles:a}=e,l=n?.startItemIndex??0,o=n?.endItemIndex??i.length;if(o<=l)return null;const d=e.decoration===s.Diamonds?[new u,new p]:[new u];const h=new c.PaneRendererLineItemsIterator(i,l,o,a);for(;h.next();){const i=h.currentValue(),s=h.nextValue();for(const n of d)if((0,c.isValidPoint)(i)&&n.hitTest(e,i,(0,c.isValidPoint)(s)?s:null,t))return new r.HitTestResult(r.HitTarget.Regular)}return null}_drawImpl(t){if(null===this._data||0===this._data.items.length)return;(this._data.decoration===s.Diamonds?[new u(!0),new m,new p]:[new u]).forEach((e=>this._drawDecorationItem(t,e)))}_drawDecorationItem(t,e){if(null===this._data||0===this._data.items.length)return;const{lineWidth:i,lineColor:s,items:n,visibleItemsRange:a,skipHoles:l,extendToBarsEndings:r}=this._data,{context:o,horizontalPixelRatio:d,verticalPixelRatio:h}=t;let u=Math.max(Math.floor((n[0].style?.width??i)*d)),_=u%2?.5:0;e.initialize(this._data,t,n[0]);const m=a?.startItemIndex??0,p=a?.endItemIndex??n.length;if(p<=m)return;let f,y,x;o.beginPath(),e.applyColor(o,n[m].style?.color??s),e.applyLineWidth(o,u);let I=!1;const g=new c.PaneRendererLineItemsIterator(n,m,p,l);for(;g.next();){const n=g.currentValue();if(!(0,c.isValidPoint)(n)){f=void 0,I=!0;continue}const a=n.style?.color??s,l=n.style?.width??i,m=a!==y,p=l!==x,v={firstItem:g.currentValueIsFirst(),lastItem:g.currentValueIsLast(),extendToBarsEndings:r,valIsNotSameAsPrev:n.valIsNotSameAsPrev},P={y:Math.round(n.y*h)+_,left:Math.round(n.left*d)+_,center:Math.round(n.center*d)+_,right:Math.round(n.right*d)+_};(m||p||I)&&(y&&x&&e.finishFragment(o,P,f),m&&e.applyColor(o,a),p&&(u=Math.max(1,Math.floor(l*d)),
_=u%2?.5:0,e.applyLineWidth(o,u)),e.startFragment(o,P,v,f),I=!1,y=a,x=l),e.drawItem(t,P,v,f),f=P}e.finishFragment(o)}}},836687:(t,e,i)=>{i.d(e,{SelectionIndexes:()=>n});var s=i(650151);class n{constructor(t){this._baseIndex=null,this._offsetInBar=null,this._offsetInTime=null,this._barsBetweenPoints=null,this._timescale=t}indexes(){const t=this._timescale.visibleBarsStrictRange();if(null===t)return[];const e=t.firstBar(),i=t.lastBar();if(null===this._offsetInTime||null===this._barsBetweenPoints){const t=this._timescale.barSpacing();this._barsBetweenPoints=Math.floor(120/t),this._offsetInBar=i%this._barsBetweenPoints,this._offsetInTime=this._timescale.indexToTimePoint(this._offsetInBar),this._baseIndex=this._timescale.baseIndex()}const n=this._timescale.baseIndex();this._baseIndex!==n&&(this._baseIndex=n,this._offsetInBar=(0,s.ensureNotNull)(this._timescale.timePointToIndex(this._offsetInTime)));const a=(0,s.ensureNotNull)(this._offsetInBar),l=[];let r=Math.floor((e-a)/this._barsBetweenPoints);const o=Math.floor((i-a)/this._barsBetweenPoints);for(;r<=o;r++)l.push(a+r*this._barsBetweenPoints);return l}clear(){this._offsetInBar=null,this._offsetInTime=null,this._baseIndex=null,this._barsBetweenPoints=null}}},112377:(t,e,i)=>{i.d(e,{SelectionRenderer:()=>d});var s=i(934026),n=i(790188),a=i(509078),l=i(86e3),r=i(961970);const o=n.colorsPalette["color-tv-blue-600"];class d extends r.BitmapCoordinatesPaneRenderer{constructor(t){super(),this._data=t||null}setData(t){this._data=t}hitTest(t){if(!this._data||!this._data.visible)return null;for(let e=0;e<this._data.points.length;e++){const i=this._data.points[e];if(i.point.subtract(t).length()<=5.5)return new a.HitTestResult(this._data.hittestResult,{pointIndex:i.pointIndex,cursorType:i.cursorType??l.PaneCursorType.Default})}return null}doesIntersectWithBox(t){return!!this._data&&this._data.points.some((e=>(0,s.pointInBox)(e.point,t)))}_drawImpl(t){if(null===this._data||!this._data.visible)return;const{context:e,horizontalPixelRatio:i}=t;e.strokeStyle=void 0!==this._data.color?this._data.color:o,e.lineCap="butt";const s=Math.max(1,Math.floor(i));e.lineWidth=s;const n=this._data.vertOffset||0;for(let i=0;i<this._data.points.length;++i){const l=this._data.points[i];(a=l.point,Number.isFinite(a.x)&&Number.isFinite(a.y))&&(e.fillStyle=this._data.bgColors[i],this._drawMarker(t,{center:l.point.x,y:l.point.y},n,s))}var a}_drawMarker(t,e,i,s){const{context:n,horizontalPixelRatio:a,verticalPixelRatio:l}=t;let r=Math.round(3.5*a*2);r%2!=s%2&&(r+=1);let o=Math.round(r+2*(.5*s+.75*a));o%2!=s%2&&(o+=1);const d=Math.round(e.center*a),h=Math.round((e.y+i)*l),c=s%2/2;n.beginPath(),n.arc(d+c,h+c,o/2,0,2*Math.PI,!0),n.closePath(),n.fill(),n.beginPath(),n.arc(d+c,h+c,r/2,0,2*Math.PI,!0),n.closePath(),n.stroke()}}},181530:(t,e,i)=>{function s(t,e){if(null===t)return e;const i=t.firstIndex,s=e.firstIndex,n=t.clearData||e.clearData;return{firstIndex:n||void 0===i||void 0===s?void 0:Math.min(i,s),clearData:n}}i.d(e,{mergeDataInvalidation:()=>s})},40563:(t,e,i)=>{function s(t){t.lineWidth=void 0,
t.lineStyle=void 0;for(let e=0;e<t.colors.length;e++)t.colors[e]=void 0;return t}function n(){return{colors:[void 0,void 0,void 0,void 0,void 0,void 0,void 0],lineWidth:void 0,lineStyle:void 0}}i.d(e,{clearStyle:()=>s,createEmptyStyle:()=>n})},559678:(t,e,i)=>{i.d(e,{PaneRendererColumns:()=>a});var s=i(961970),n=i(509078);class a extends s.BitmapCoordinatesPaneRenderer{constructor(t){super(),this._data=null,this._precalculatedCache=[],this.setData(t)}setData(t){this._data=t,this._precalculatedCache=[]}hitTest(t){if(null===this._data)return null;const e=this._data.visibleItemsRange?.startItemIndex??0,i=(this._data.visibleItemsRange?.endItemIndex??this._data.items.length)-1;for(let s=e;s<=i;s++){const e=this._data.items[s];if(t.x>=e.left&&t.x<=e.right){const i=e.y;if(t.y>=Math.min(i,this._data.histogramBase)&&t.y<=Math.max(i,this._data.histogramBase))return new n.HitTestResult(n.HitTarget.Regular)}}return null}_drawImpl(t){if(null===this._data||0===this._data.items.length)return;const{context:e,horizontalPixelRatio:i,verticalPixelRatio:s}=t;this._precalculatedCache.length||this._fillPrecalculatedCache(i);const n=Math.max(1,Math.floor(i)),a=Math.max(1,Math.floor(s)),l=Math.round(this._data.histogramBase*s)-Math.floor(n/2),r=l+n,o=this._data.lineColor,d=this._data.visibleItemsRange?.startItemIndex??0,h=(this._data.visibleItemsRange?.endItemIndex??this._data.items.length)-1;for(let t=d;t<=h;t++){const i=this._data.items[t],n=this._precalculatedCache[t-d],h=Math.round(i.y*s);let c,u;e.fillStyle=i.style?i.style.color:o,h<=l?(c=h,u=r):(c=l,u=h-Math.floor(a/2)+a),e.fillRect(n.left,c,n.right-n.left+1,u-c)}}_fillPrecalculatedCache(t){if(null===this._data||0===this._data.items.length)return void(this._precalculatedCache=[]);const{barSpacing:e,visibleItemsRange:i,items:s}=this._data,n=Math.ceil(e*t)<=1?0:Math.max(1,Math.floor(t)),a=i?.startItemIndex??0,l=(i?.endItemIndex??s.length)-1,r=l-a+1;if(r<=0)return void(this._precalculatedCache=[]);this._precalculatedCache=new Array(r);for(let e=a;e<=l;e++){const i=s[e],l=Math.round(i.center*t);let r,o;const d=Math.round((i.right-i.left)*t)-n;if(d%2){const t=(d-1)/2;r=l-t,o=l+t}else{const t=d/2;r=l-t,o=l+t-1}this._precalculatedCache[e-a]={left:r,right:o,roundedCenter:l,center:i.center*t,time:i.timePointIndex}}for(let t=a+1;t<=l;t++){const e=this._precalculatedCache[t-a],i=this._precalculatedCache[t-a-1];e.time===i.time+1&&(e.left-i.right!==n+1&&(i.roundedCenter>i.center?i.right=e.left-n-1:e.left=i.right+n+1))}let o=Math.ceil(e*t);for(let t=a+1;t<=l;t++){const e=this._precalculatedCache[t-a];e.right<e.left&&(e.right=e.left);const i=e.right-e.left+1;o=Math.min(i,o)}if(n>0&&o<4)for(let t=a+1;t<=l;t++){const e=this._precalculatedCache[t-a];e.right-e.left+1>o&&(e.roundedCenter>e.center?e.right-=1:e.left+=1)}}}},703614:(t,e,i)=>{i.d(e,{StudyPlotPaneView:()=>k})
;var s=i(650151),n=i(724377),a=i(764829),l=i(750139),r=i(124829),o=i(432059),d=i(387964),h=i(199872),c=i(403862),u=i(982949),_=i(708698),m=i(810873),p=i(112377),f=i(40563),y=i(296842),x=i(86441),I=i(286436),g=i(509078),v=i(961970),P=i(638456);class S extends v.BitmapCoordinatesPaneRenderer{constructor(t){super(),this._data=t}hitTest(t){const e=this._data,i=e.lineWidth,s=e.vertOffset||0,n=(0,I.interactionTolerance)().series+i,a=e.visibleItemsRange?.startItemIndex??0,l=e.visibleItemsRange?.endItemIndex??e.items.length;for(let r=a;r<l;r++){const a=e.items[r];if(new x.Point(a.center,a.y+s).subtract(t).length()+i<=n)return new g.HitTestResult(g.HitTarget.Regular)}return null}_drawImpl(t){const e=this._data,{horizontalPixelRatio:i,verticalPixelRatio:s,context:n}=t,a=Math.max(1,Math.floor(i))%2?.5:0,l=e.vertOffset||0,o=e.lineColor,d=e.lineWidth;let h="",c=!1;const u=e.visibleItemsRange?.startItemIndex??0,_=e.visibleItemsRange?.endItemIndex??e.items.length;for(let t=u;t<_;t++){const u=e.items[t],_=u.center,m=u.y+l;if((0,r.isNaN)(_)||(0,r.isNaN)(m))continue;let p,f;null!=u.style?(p=u.style.color,f=u.style.width):(p=o,f=d),(p!==h||P.isSafari)&&(h=p,c&&n.fill(),n.beginPath(),n.fillStyle=p);const y=Math.round(_*i)+a,x=Math.round(m*s)+a,I=Math.round(f*i)+a;n.moveTo(y+I,x),n.arc(y,x,I,0,2*Math.PI,!1),c=!0}c&&n.fill()}}var b=i(559678),w=i(204652);class C extends v.BitmapCoordinatesPaneRenderer{constructor(t){super(),this._data=t}hitTest(t){const e=(0,I.interactionTolerance)().series+this._data.lineWidth/2;let i,s,n,a;for(let l=1;l<this._data.items.length;++l){i=this._data.items[l-1],s=this._data.items[l],n=i.center,a=s.center;if((0,w.distanceToSegment)(new x.Point(n,i.y),new x.Point(a,s.y),new x.Point(t.x,t.y)).distance<=e)return new g.HitTestResult(g.HitTarget.Regular)}return null}_drawImpl(t){const{context:e,horizontalPixelRatio:i,verticalPixelRatio:s}=t;let n="",a=!1;const l=this._data.visibleItemsRange?.startItemIndex??0,o=(this._data.visibleItemsRange?.endItemIndex??this._data.items.length)-1;for(let t=l;t<=o;t++){const l=this._data.items[t];if((0,r.isNaN)(l.center)||(0,r.isNaN)(l.y))continue;const o=l.style?.color??this._data.lineColor,d=l.style?.width??this._data.lineWidth,h=Math.max(1,Math.floor(d*i)),c=Math.max(1,Math.floor(d*s));(o!==n||P.isSafari)&&(n=o,a&&e.fill(),e.beginPath(),e.fillStyle=o);let u=3*h;u%2!=h%2&&(u+=1);let _=3*c;_%2!=c%2&&(_+=1);const m=Math.round(Math.round(l.center*i)-u/2),p=Math.round(Math.round(l.y*s)-_/2),f=m+Math.floor(u/2-h/2),y=p+Math.floor(_/2-c/2);e.rect(m,y,u,c),e.rect(f,p,h,_),a=!0}a&&e.fill()}}class R extends v.BitmapCoordinatesPaneRenderer{constructor(t){super(),this._data=t}hitTest(t){const e=(0,I.interactionTolerance)().series+this._data.lineWidth/2,i=new Map;for(const n of this._data.items){const a=n.center,l=n.y;let r=e;n.style&&(i.has(n.style.width)?r=(0,s.ensureDefined)(i.get(n.style.width)):i.set(this._data.lineWidth,r));if((0,
w.distanceToSegment)(new x.Point(a,l),new x.Point(a,this._data.histogramBase),new x.Point(t.x,t.y)).distance<=r)return new g.HitTestResult(g.HitTarget.Regular)}return null}_drawImpl(t){if(0===this._data.items.length)return;const{context:e,horizontalPixelRatio:i,verticalPixelRatio:s}=t;e.fillStyle=this._data.lineColor;const n=Math.max(1,Math.floor(this._data.lineWidth*i)),a=n/2,l=Math.max(1,Math.floor(i)),r=Math.round(this._data.histogramBase*s)-Math.floor(l/2),o=r+l,d=this._data.visibleItemsRange?.startItemIndex??0,h=(this._data.visibleItemsRange?.endItemIndex??this._data.items.length)-1;for(let t=d;t<=h;t++){const d=this._data.items[t];let h=n,c=a;d.style?(e.fillStyle=d.style.color,h=Math.max(1,Math.floor(d.style.width*i)),c=h/2):e.fillStyle=this._data.lineColor;const u=h%2?.5:0,_=Math.round(d.center*i)+u,m=Math.round(d.y*s);let p,f;m<=r?(p=m,f=o):(p=r,f=m-Math.floor(l/2)+l),e.fillRect(Math.floor(_-c),p,h,f-p)}}}var N=i(748947),M=i(962973),T=i(828473),B=i(337827);const L=t=>{const e=(0,n.rgbToHsl)((0,n.parseRgb)(t)),i=e[0]+.05;return e[0]=i-Math.floor(i),(0,n.rgbToHexString)((0,n.hslToRgb)(e))},V=(0,h.memoize)(L),W=new Set([N.LineStudyPlotStyle.Line,N.LineStudyPlotStyle.Area,N.LineStudyPlotStyle.Circles,N.LineStudyPlotStyle.Cross,N.LineStudyPlotStyle.StepLine,N.LineStudyPlotStyle.StepLineWithDiamonds]);class k extends B.StudyPaneViewInplaceUpdatable{constructor(t,e,i,s,n=!1){super(e,i,s),this._histogramBase=null,this._lineColor="",this._lineWidth=1,this._color1="",this._color2="",this._renderer=new u.CompositeRenderer,this._isMarkersEnabled=a.enabled("source_selection_markers"),this._study=t,this._plotIndex=t.metaInfo().plots.findIndex((t=>t.id===s)),this._colorProvider=(0,M.createStudyPlotColorProvider)(t.metaInfo(),t.properties(),s),this._extendStepLineToBarsEndings=n,this._isFundamental=(0,y.isFundamentalStudyMetaInfo)(t.metaInfo());const l=this._study.properties().styles[this._plotName].plottype.value();this._isStepLinePlot=l===N.LineStudyPlotStyle.StepLine||l===N.LineStudyPlotStyle.StepLineWithBreaks||l===N.LineStudyPlotStyle.StepLineWithDiamonds}items(){return this._items}renderer(){return this._makeSureRendererIsValid(),this._renderer}_getTranspValue(){const t=this._study.properties(),e=t.styles[this._plotName];let i=0;const s=this._study.metaInfo();return"Volume@tv-basicstudies"===s.id&&s.version<=46&&"transparency"in t?(i=t.transparency.value(),i=(0,r.isNumber)(i)?i:0,i):(e.transparency&&(i=e.transparency.value(),i=(0,r.isNumber)(i)?i:0),i)}_updateImplFull(t){if(this._renderer.clear(),this._dataInvalidated?.clearData&&(this._items=[]),!this._study.isPlotVisibleAt(this._plotName,1))return!1;const e=this._priceScale();if(!e||e.isEmpty())return!1;if(null===this._study.firstValue(void 0,this.isForceOverlay()))return!1;this._histogramBase=null;const i=this._study.properties().styles[this._plotName],n=i.plottype.value(),a=this._isFundamental&&this._isStepLinePlot,r=this._study.plots().plottableRange(a);if(0===r.size())return!1
;const h=this._study.offset(this._plotName),c=W.has(n),u=this._preallocateItems(r,((t,e)=>({y:NaN,left:NaN,center:NaN,right:NaN,origPrices:{price:e??NaN,timePointIndex:t+h},timePointIndex:t+h})));let _=NaN,m=NaN;const p=new Map,y=(t,e)=>{let i=p.get(t);void 0===i&&(i=new Map,p.set(t,i));let s=i.get(e);if(void 0===s){const n=!this._plotName||"vol"!==this._plotName;s=(0,o.generateColor)(t,e,n),i.set(e,s)}return s},x=(0,f.createEmptyStyle)(),I=(0,l.clamp)(this._getTranspValue(),0,100),g=this._model.timeScale().visibleBarsStrictRange();if(null===g)return!1;const{startBar:v,endBar:P}=this._calculateStartEnd(g);if(null===v||null===P||0===this._items.length)return!1;const S=u??(0,s.ensureNotNull)(r.firstIndex()),b=(0,s.ensureNotNull)(r.lastIndex())+1,w=r.rangeIterator(S,b);let C,R=(0,T.lowerbound)(this._items,S+h,((t,e)=>t.timePointIndex<e));for(const t of w){let e=t.index;const s=t.value;e+=h,e=Math.floor(e);let n=s[this._plotIndex+1];const a=null==n;if(n=a?NaN:n,c&&a){m=n,_=e,R++;continue}const l=this._items[R];l.valIsNotSameAsPrev=n!==m||e-1!==_;if(this._colorProvider.isColorDefined()&&(l.style={color:y(i.color.value(),100),width:i.linewidth.value(),style:i.linestyle.value()},null!=n)){const t=this._colorProvider.getPlotPointStyle(s,x),e=t.colors[0];void 0!==e&&(l.style.color=(0,o.isHexColor)(e)?y(e,I):e),l.style.width=t.lineWidth??l.style.width,l.style.style=t.lineStyle??l.style.style}!c&&!isNaN(_)&&_!==e-1&&R>0&&(this._items[R].breakBefore=!0),m=n,_=e,R++,C=l}if(C&&this._isFundamental&&this._isStepLinePlot){const t=this._model.mainSeries().data().bars().lastIndex(),e=C;if(null!==t&&t>e.timePointIndex){const i=(0,d.deepCopy)(e);i.timePointIndex=t,i.valIsNotSameAsPrev=!1,this._items.length>R?this._items[R]=i:this._items.push(i)}}return this._updateImplLight(),!0}_correctVisibleItemIndexes(t,e){const i=super._correctVisibleItemIndexes(t,e);return this._isFundamental&&this._isStepLinePlot&&i.endItemIndex===this._items.length-1&&(i.endItemIndex+=1),i}_updateRenderer(t,e){this._renderer.clear();const i=this._study.properties().styles.childs()[this._plotName].childs(),n=this._study.metaInfo().styles?.[this._plotName],a=(0,l.clamp)(this._getTranspValue(),0,100);this._lineColor=(0,o.generateColor)(i.color.value(),a),this._lineWidth=i.linewidth.value();let h=i.color.value();const u=this._colorProvider.getDefaultPlotPointStyle();u&&(h=u.colors[0]||h,this._lineWidth=u.lineWidth??this._lineWidth,this._lineColor=h?(0,o.generateColor)(h,a):this._lineColor),this._color2=(0,o.generateColor)(h,a);const f=this._study.metaInfo().isRGB?L(h):V(h);this._color1=(0,o.generateColor)(f,a);const y=this._histogramBase?this._histogramBase:(0,s.ensureNotNull)(this._priceScale()).height(),x=i.plottype.value(),I={barSpacing:this._model.timeScale().barSpacing(),items:this._items,histogramBase:y,lineIndex:0,lineStyle:i.linestyle.value(),lineColor:this._lineColor,lineWidth:(0,r.isNumber)(this._lineWidth)?this._lineWidth:1,color1:this._color1,color2:this._color2,bottom:y,visibleItemsRange:{startItemIndex:t,endItemIndex:e},
simpleMode:this._colorProvider.singleColor(),skipHoles:[N.LineStudyPlotStyle.Line,N.LineStudyPlotStyle.Area,N.LineStudyPlotStyle.Cross,N.LineStudyPlotStyle.Circles,N.LineStudyPlotStyle.StepLine,N.LineStudyPlotStyle.StepLineWithDiamonds].includes(x)},g=this._renderer,v=Boolean(n?.joinPoints);switch(x){case N.LineStudyPlotStyle.Line:case N.LineStudyPlotStyle.LineWithBreaks:g.append(new _.PaneRendererLine(I));break;case N.LineStudyPlotStyle.Area:case N.LineStudyPlotStyle.AreaWithBreaks:g.append(new c.PaneRendererArea(I));break;case N.LineStudyPlotStyle.Histogram:g.append(new R(I));break;case N.LineStudyPlotStyle.Columns:g.append(new b.PaneRendererColumns(I));break;case N.LineStudyPlotStyle.Cross:g.append(new C(I)),v&&g.append(new _.PaneRendererLine({...(0,d.deepCopy)(I),lineWidth:1,forceLineWidth:!0}));break;case N.LineStudyPlotStyle.Circles:g.append(new S(I)),v&&g.append(new _.PaneRendererLine({...(0,d.deepCopy)(I),lineWidth:1,ignorePaletteLineWidth:!0}));break;case N.LineStudyPlotStyle.StepLine:case N.LineStudyPlotStyle.StepLineWithBreaks:case N.LineStudyPlotStyle.StepLineWithDiamonds:{const t=new m.PaneRendererStepLine;t.setData({...I,decoration:i.plottype.value()===N.LineStudyPlotStyle.StepLineWithDiamonds?m.StepLineDecoration.Diamonds:m.StepLineDecoration.None,extendToBarsEndings:this._extendStepLineToBarsEndings}),g.append(t);break}default:g.append(new _.PaneRendererLine(I))}this._model.selection().isSelected(this._study)&&this._isMarkersEnabled&&this._selectionData&&g.append(new p.SelectionRenderer(this._selectionData))}_updateAdditionalPrices(t,e){const i=this._study.metaInfo().styles?.[this._plotName];void 0!==i?.histogramBase&&(this._histogramBase=t.priceToCoordinate(i.histogramBase,e))}}},249121:(t,e,i)=>{i.d(e,{StudyForceOverlayPlotView:()=>s});class s{constructor(t,e,i){this._series=t,this._model=e,this._plotName=i}isForceOverlay(){return!!this._study.metaInfo().isPlotForceOverlay(this._plotName)}_priceScale(){return this.isForceOverlay()?this._model.mainSeries().priceScale():this._study.priceScale()}}},337827:(t,e,i)=>{i.d(e,{StudyPaneViewInplaceUpdatable:()=>c});var s=i(650151),n=i(86441),a=i(181530),l=i(518439),r=i(828473),o=i(836687),d=i(509078),h=i(249121);class c extends h.StudyForceOverlayPlotView{constructor(t,e,i){super(t,e,i),this._selectionData=null,this._dataInvalidated=null,this._viewportInvalidated=!1,this._items=[],this._selectionIndexer=new o.SelectionIndexes(e.timeScale())}update(t){if("global-change"===t.type)return this._dataInvalidated=(0,a.mergeDataInvalidation)(this._dataInvalidated,{}),void(this._viewportInvalidated=!0);if("data-source-change"!==t.type)this._viewportInvalidated=!0;else{if((t.sourceId===this._study.id()||this._dependsOnSeriesData()&&t.sourceId===this._model.mainSeries().id())&&!t.nonSeriesOnly){const e=(0,a.mergeDataInvalidation)(this._dataInvalidated,{firstIndex:t.firstUpdatedTimePointIndex,clearData:t.clearData});this._dataInvalidated=e}}}_dependsOnSeriesData(){return!1}_makeSureRendererIsValid(){
this._dataInvalidated?this._updateImplFull(this._viewportInvalidated)&&(this._dataInvalidated=null):this._viewportInvalidated&&this._updateImplLight(),this._viewportInvalidated=!1}_preallocateItems(t,e){const i=t.size(),n=this._dataInvalidated?.firstIndex;if(0===i)return n;const a=this._study.offset(this._plotName);if(i!==this._items.length){const i=void 0!==n?n+a:void 0;if(void 0===i||0===this._items.length||i<(0,s.ensureDefined)(this._items[0].timePointIndex))return this._items=[],t.each(((t,i)=>{const s=i[this._plotIndex+1];return this._items.push(e(t,s)),!1})),this._items.length?(0,s.ensureDefined)(this._items[0].timePointIndex)-a:void 0;{const i=(0,s.ensureDefined)(n),l=a>=0?0:a,o=a>=0?a:0;let d=(0,r.lowerbound)(this._items,i+l,((t,e)=>t.timePointIndex<e));const h=(0,s.ensureNotNull)(t.lastIndex()),c=t.rangeIterator(i-o,h);for(const t of c)if(void 0!==d&&this._items[d]?.timePointIndex===t.index+a)d=this._updateItem(t,d);else{const i=t.value[this._plotIndex+1];this._items.push(e(t.index,i))}}}else if(void 0!==n){const e=a>=0?0:a,i=a>=0?a:0;let l=(0,r.lowerbound)(this._items,n+e,((t,e)=>t.timePointIndex<e));const o=(0,s.ensureNotNull)(t.lastIndex())+1,d=t.rangeIterator(n-i,o);for(const t of d)l=this._updateItem(t,l)}return n}_updateItem(t,e){const i=this._getValueForUpdating(t);return this._items[e].origPrices.price=i??NaN,e+1}_getValueForUpdating(t){return t.value[this._plotIndex+1]}_calculateStartEnd(t){const e=this._study.offset(this._plotName);let i=t.firstBar()-Math.abs(e)-1,n=t.lastBar()+Math.abs(e)+1;const a=this._study.getMinFirstBarIndexForPlot(this._plotName)+e;if(a>n+1)return{startBar:null,endBar:null};let r=this._study.plots();r=r.range(a,(0,s.ensureNotNull)(r.lastIndex())),i=Math.max(i,a),n=Math.max(n,a);const o=r.search(i,l.PlotRowSearchMode.NearestLeft,this._plotIndex+1),d=r.search(n,l.PlotRowSearchMode.NearestRight,this._plotIndex+1);return null!==o&&(i=o.index),null!==d&&(n=d.index),i=Math.max(a,i),{startBar:i,endBar:n}}_updateImplLight(){const t=this._study.firstValue(void 0,this.isForceOverlay());if(null===t)return this._selectionData=null,void this._updateRenderer(0,-1);const e=this._priceScale();if(null===e||e.isEmpty())return this._selectionData=null,void this._updateRenderer(0,-1);const i=this._model.timeScale().visibleBarsStrictRange();if(null===i)return this._selectionData=null,void this._updateRenderer(0,-1);const{startBar:s,endBar:n}=this._calculateStartEnd(i);if(null===s||null===n||0===this._items.length)return this._selectionData=null,void this._updateRenderer(0,-1);const{startItemIndex:a,endItemIndex:l}=this._correctVisibleItemIndexes(Math.max(0,(0,r.lowerbound)(this._items,s,((t,e)=>t.timePointIndex<e))),Math.min(this._items.length,(0,r.upperbound)(this._items,n,((t,e)=>t<e.timePointIndex))));if(a>=l)return this._selectionData=null,void this._updateRenderer(0,-1);this._convertItemsToCoordinates(e,t,a,l),this._createSelection(t),this._updateRenderer(a,l)}_correctVisibleItemIndexes(t,e){return{startItemIndex:t,endItemIndex:e}}_convertItemsToCoordinates(t,e,i,s){
this._convertItemsToCoordinatesImpl(t,e,i,s)}_convertItemsToCoordinatesImpl(t,e,i,s){for(let t=i;t<s;t++){const e=this._items[t];e.y=e.origPrices.price}t.pointsArrayToCoordinates(this._items,e,{startItemIndex:i,endItemIndex:s}),this._model.timeScale().fillBarBorders(this._items,{startItemIndex:i,endItemIndex:s},!0),this._updateAdditionalPrices(t,e)}_updateAdditionalPrices(t,e){}_createSelection(t){const e=this._priceScale();if(null!==e)if(this._model.selection().isSelected(this._study)){const i=this._selectionIndexer.indexes(),a=(0,s.ensureNotNull)(this._model.paneForSource(this._study)).height();this._selectionData={points:[],bgColors:[],visible:!0,hittestResult:d.HitTarget.Regular,barSpacing:this._model.timeScale().barSpacing()};const l=this._study.offset(this._plotName);for(let s=0;s<i.length;s++){let r=i[s];const o=this._study.plots().valueAt(r);if(r+=l,null===o)continue;const d=o[this._plotIndex+1];if(null==d)continue;const h=this._model.timeScale().indexToCoordinate(Math.floor(r)),c=e.priceToCoordinate(d,t);this._selectionData.points.push({point:new n.Point(h,c)}),this._selectionData.bgColors.push(this._model.backgroundColorAtYPercentFromTop(c/a))}}else this._selectionIndexer.clear()}}},962973:(t,e,i)=>{i.d(e,{createStudyPlotColorProvider:()=>_});var s=i(748947),n=i(650151),a=i(40563);const l=new Map([[0,"color"],[2,"textColor"],[3,"borderColor"],[4,"wickColor"],[5,"colorup"],[6,"colordown"]]);class r{constructor(t){this._plotStyle=t}getPlotPointStyle(t,e){const i=e?(0,a.clearStyle)(e):(0,a.createEmptyStyle)();return l.forEach(((t,e)=>{this._plotStyle[t]&&(i.colors[e]=this._plotStyle[t].value())})),i.lineWidth=this._plotStyle.linewidth?this._plotStyle.linewidth.value():void 0,i.lineStyle=this._plotStyle.linestyle?this._plotStyle.linestyle.value():void 0,i}isColorDefined(){return!0}singleColor(){return!0}getDefaultPlotPointStyle(){return null}}const o=[0,1,2,3,4,5,6];class d{constructor(t,e,i,s){this._palettesColors=new Map,this._defaultPlotColors=new Map,this._indexes=s;const a=e.styles[i];if(a)for(const[t,e]of l)this._defaultPlotColors.set(t,a[e]);const r=(0,n.ensureDefined)(t.palettes),o=t.plots;s.forEach(((t,i)=>{const s=o[t];if(s&&"palette"in s){const t=r[s.palette],n=e.palettes[s.palette];if(t&&n){const{valToIndex:e}=t,{colors:s}=n,a={...s};e&&Object.keys(e).forEach((t=>{const i=e[t];void 0!==i&&(a[t]=s[i])})),this._palettesColors.set(i,a)}}}))}getPlotPointStyle(t,e){const i=e?(0,a.clearStyle)(e):(0,a.createEmptyStyle)();return o.forEach((e=>{if(this._palettesColors.has(e)){const s=t[(0,n.ensureDefined)(this._indexes.get(e))+1];if("number"==typeof s){const t=this._palettesColors.get(e)?.[s];0===e&&t&&(i.lineWidth=t.width.value(),i.lineStyle=t.style.value()),i.colors[e]=t?.color.value()}else i.colors[e]="transparent"}else i.colors[e]=this._defaultPlotColors.get(e)?.value()})),i}getDefaultPlotPointStyle(){const t=this._palettesColors.get(0)?.[0];if(void 0!==t){return{colors:[t.color.value(),void 0,void 0,void 0,void 0,void 0,void 0],lineStyle:void 0,lineWidth:t.width.value()}}return null}isColorDefined(){
return!!this._palettesColors.size}singleColor(){return!1}}var h=i(19932);class c{constructor(t){this._rgbaFromInteger=(0,h.rgbaFromIntegerCached)(),this._indexes=t}getPlotPointStyle(t,e){const i=e?(0,a.clearStyle)(e):(0,a.createEmptyStyle)();return this._indexes.forEach(((e,s)=>{const n=t[e+1];if(null!=n){const t=this._rgbaFromInteger(n);i.colors[s]=t}else i.colors[s]="transparent"})),i}isColorDefined(){return!0}singleColor(){return!1}getDefaultPlotPointStyle(){return null}}const u=new Map([[0,function(t,e){const i=(0,s.isColorerPlot)(e)||(0,s.isOhlcColorerPlot)(e);return"target"in e&&e.target===t&&i}],[2,function(t,e){const i=(0,s.isTextColorerPlot)(e);return"target"in e&&e.target===t&&i}],[1,function(t,e){return(0,s.isBgColorerPlot)(e)&&e.id===t}],[3,function(t,e){const i=(0,s.isCandleBorderColorerPlot)(e);return"target"in e&&e.target===t&&i}],[4,function(t,e){const i=(0,s.isCandleWickColorerPlot)(e);return"target"in e&&e.target===t&&i}],[5,function(t,e){const i=(0,s.isUpColorerPlot)(e);return"target"in e&&e.target===t&&i}],[6,function(t,e){const i=(0,s.isDownColorerPlot)(e);return"target"in e&&e.target===t&&i}]]);function _(t,e,i){const{colorers:s}=function(t,e){const i=t.plots,s=i.findIndex((t=>t.id===e)),n=new Map;return i.forEach(((t,i)=>{u.forEach(((s,a)=>{s(e,t)&&n.set(a,i)}))})),{plotIndex:-1===s?null:s,colorers:n}}(t,i);if(s.size)return t.isRGB?new c(s):new d(t,e,i,s);{const t=e.ohlcPlots;if(t&&t[i])return new r(t[i]);const s=e.styles[i];return new r(s)}}},125624:(t,e,i)=>{i.d(e,{StudyPriceAxisView:()=>l});var s=i(650151),n=i(347808),a=i(432059);class l extends n.PriceAxisView{constructor(t,e){super(),this._model=t.model(),this._source=t,this._data=e,this._isForceOverlay=!!this._source.metaInfo().isPlotForceOverlay(this._data.plotIndex)}_updateRendererData(t,e,i){t.visible=!1,e.visible=!1;const n=this._source.model(),l=this._isForceOverlay?n.mainSeries().priceScale():this._source.priceScale();if(null===l)return;if(!n.isPriceScaleVisible(l))return;const r=this._source.lastValueData(this._data.plotIndex,!1);if(r.noData)return;const o=n.timeScale().visibleBarsStrictRange(),d=n.mainSeries().bars().lastIndex();if(null!==o&&null!==d){if(d<=o.lastBar()){i.background=(0,a.resetTransparency)(r.color);let s=r.color;"transparent"===s&&(s=this._model.properties().childs().scalesProperties.childs().backgroundColor.value()),i.textColor=this.generateTextColor(s),i.borderColor=void 0,t.borderVisible=!1,e.borderVisible=!1}else{const l=n.backgroundColorAtYPercentFromTop(r.coordinate/(0,s.ensureNotNull)(n.paneForSource(this._source)).height());i.background=l,i.textColor=(0,a.resetTransparency)(r.color),i.borderColor=(0,a.resetTransparency)(i.textColor),t.borderVisible=!0,e.borderVisible=!0}i.coordinate=r.coordinate,i.floatCoordinate=r.floatCoordinate,this._showAxisLabel()&&(t.text=r.text,t.visible=!0),this._updatePaneRendererData(e)}}_showPaneLabel(){const t=this._model.properties().childs().scalesProperties.childs()
;return(t.showStudyPlotLabels.value()||t.showFundamentalNameLabel.value())&&this._source.properties().childs().showLabelsOnPriceScale.value()&&this._source.isPlotVisibleAt(this._data.plotIndex,4)}_showAxisLabel(){const t=this._model.properties().childs().scalesProperties.childs();return(t.showStudyLastValue.value()||t.showFundamentalLastValue.value())&&this._source.properties().childs().showLabelsOnPriceScale.value()&&this._source.isPlotVisibleAt(this._data.plotIndex,4)}_updatePaneRendererData(t){t.text="",this._showPaneLabel()&&(t.text=this._source.priceLabelText(this._data.plotIndex),t.visible=!0)}}},19932:(t,e,i)=>{i.d(e,{rgbaFromIntegerCached:()=>l});var s=i(259332),n=i(432059),a=i(211414);function l(t=1e3){const e=s.default.Cache;s.default.Cache=a.CircularCacheBuffer.bind(a.CircularCacheBuffer,t);const i=(0,s.default)(n.rgbaFromInteger);return s.default.Cache=e,i}}}]);